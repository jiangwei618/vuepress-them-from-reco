
<!DOCTYPE html>
<html>
  <head>
    <title>no title</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
    .markdown-preview{width:100%;height:100%;box-sizing:border-box}.markdown-preview .pagebreak,.markdown-preview .newpage{page-break-before:always}.markdown-preview pre.line-numbers{position:relative;padding-left:3.8em;counter-reset:linenumber}.markdown-preview pre.line-numbers>code{position:relative}.markdown-preview pre.line-numbers .line-numbers-rows{position:absolute;pointer-events:none;top:1em;font-size:100%;left:0;width:3em;letter-spacing:-1px;border-right:1px solid #999;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.markdown-preview pre.line-numbers .line-numbers-rows>span{pointer-events:none;display:block;counter-increment:linenumber}.markdown-preview pre.line-numbers .line-numbers-rows>span:before{content:counter(linenumber);color:#999;display:block;padding-right:.8em;text-align:right}.markdown-preview .mathjax-exps .MathJax_Display{text-align:center !important}.markdown-preview:not([for="preview"]) .code-chunk .btn-group{display:none}.markdown-preview:not([for="preview"]) .code-chunk .status{display:none}.markdown-preview:not([for="preview"]) .code-chunk .output-div{margin-bottom:16px}.scrollbar-style::-webkit-scrollbar{width:8px}.scrollbar-style::-webkit-scrollbar-track{border-radius:10px;background-color:transparent}.scrollbar-style::-webkit-scrollbar-thumb{border-radius:5px;background-color:rgba(150,150,150,0.66);border:4px solid rgba(150,150,150,0.66);background-clip:content-box}html body[for="html-export"]:not([data-presentation-mode]){position:relative;width:100%;height:100%;top:0;left:0;margin:0;padding:0;overflow:auto}html body[for="html-export"]:not([data-presentation-mode]) .markdown-preview{position:relative;top:0}@media screen and (min-width:914px){html body[for="html-export"]:not([data-presentation-mode]) .markdown-preview{padding:2em calc(50% - 457px + 2em)}}@media screen and (max-width:914px){html body[for="html-export"]:not([data-presentation-mode]) .markdown-preview{padding:2em}}@media screen and (max-width:450px){html body[for="html-export"]:not([data-presentation-mode]) .markdown-preview{font-size:14px !important;padding:1em}}@media print{html body[for="html-export"]:not([data-presentation-mode]) #sidebar-toc-btn{display:none}}html body[for="html-export"]:not([data-presentation-mode]) #sidebar-toc-btn{position:fixed;bottom:8px;left:8px;font-size:28px;cursor:pointer;color:inherit;z-index:99;width:32px;text-align:center;opacity:.4}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] #sidebar-toc-btn{opacity:1}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc{position:fixed;top:0;left:0;width:300px;height:100%;padding:32px 0 48px 0;font-size:14px;box-shadow:0 0 4px rgba(150,150,150,0.33);box-sizing:border-box;overflow:auto;background-color:inherit}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc::-webkit-scrollbar{width:8px}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc::-webkit-scrollbar-track{border-radius:10px;background-color:transparent}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc::-webkit-scrollbar-thumb{border-radius:5px;background-color:rgba(150,150,150,0.66);border:4px solid rgba(150,150,150,0.66);background-clip:content-box}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc a{text-decoration:none}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc ul{padding:0 1.6em;margin-top:.8em}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc li{margin-bottom:.8em}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc ul{list-style-type:none}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .markdown-preview{left:300px;width:calc(100% -  300px);padding:2em calc(50% - 457px -  150px);margin:0;box-sizing:border-box}@media screen and (max-width:1274px){html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .markdown-preview{padding:2em}}@media screen and (max-width:450px){html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .markdown-preview{width:100%}}html body[for="html-export"]:not([data-presentation-mode]):not([html-show-sidebar-toc]) .markdown-preview{left:50%;transform:translateX(-50%)}html body[for="html-export"]:not([data-presentation-mode]):not([html-show-sidebar-toc]) .md-sidebar-toc{display:none}/**
 * prism.js Github theme based on GitHub's theme.
 * @author Sam Clarke
 */
code[class*="language-"],
pre[class*="language-"] {
  color: #333;
  background: none;
  font-family: Consolas, "Liberation Mono", Menlo, Courier, monospace;
  text-align: left;
  white-space: pre;
  word-spacing: normal;
  word-break: normal;
  word-wrap: normal;
  line-height: 1.4;

  -moz-tab-size: 8;
  -o-tab-size: 8;
  tab-size: 8;

  -webkit-hyphens: none;
  -moz-hyphens: none;
  -ms-hyphens: none;
  hyphens: none;
}

/* Code blocks */
pre[class*="language-"] {
  padding: .8em;
  overflow: auto;
  /* border: 1px solid #ddd; */
  border-radius: 3px;
  /* background: #fff; */
  background: #f5f5f5;
}

/* Inline code */
:not(pre) > code[class*="language-"] {
  padding: .1em;
  border-radius: .3em;
  white-space: normal;
  background: #f5f5f5;
}

.token.comment,
.token.blockquote {
  color: #969896;
}

.token.cdata {
  color: #183691;
}

.token.doctype,
.token.punctuation,
.token.variable,
.token.macro.property {
  color: #333;
}

.token.operator,
.token.important,
.token.keyword,
.token.rule,
.token.builtin {
  color: #a71d5d;
}

.token.string,
.token.url,
.token.regex,
.token.attr-value {
  color: #183691;
}

.token.property,
.token.number,
.token.boolean,
.token.entity,
.token.atrule,
.token.constant,
.token.symbol,
.token.command,
.token.code {
  color: #0086b3;
}

.token.tag,
.token.selector,
.token.prolog {
  color: #63a35c;
}

.token.function,
.token.namespace,
.token.pseudo-element,
.token.class,
.token.class-name,
.token.pseudo-class,
.token.id,
.token.url-reference .token.variable,
.token.attr-name {
  color: #795da3;
}

.token.entity {
  cursor: help;
}

.token.title,
.token.title .token.punctuation {
  font-weight: bold;
  color: #1d3e81;
}

.token.list {
  color: #ed6a43;
}

.token.inserted {
  background-color: #eaffea;
  color: #55a532;
}

.token.deleted {
  background-color: #ffecec;
  color: #bd2c00;
}

.token.bold {
  font-weight: bold;
}

.token.italic {
  font-style: italic;
}


/* JSON */
.language-json .token.property {
  color: #183691;
}

.language-markup .token.tag .token.punctuation {
  color: #333;
}

/* CSS */
code.language-css,
.language-css .token.function {
  color: #0086b3;
}

/* YAML */
.language-yaml .token.atrule {
  color: #63a35c;
}

code.language-yaml {
  color: #183691;
}

/* Ruby */
.language-ruby .token.function {
  color: #333;
}

/* Markdown */
.language-markdown .token.url {
  color: #795da3;
}

/* Makefile */
.language-makefile .token.symbol {
  color: #795da3;
}

.language-makefile .token.variable {
  color: #183691;
}

.language-makefile .token.builtin {
  color: #0086b3;
}

/* Bash */
.language-bash .token.keyword {
  color: #0086b3;
}

/* highlight */
pre[data-line] {
  position: relative;
  padding: 1em 0 1em 3em;
}
pre[data-line] .line-highlight-wrapper {
  position: absolute;
  top: 0;
  left: 0;
  background-color: transparent;
  display: block;
  width: 100%;
}

pre[data-line] .line-highlight {
  position: absolute;
  left: 0;
  right: 0;
  padding: inherit 0;
  margin-top: 1em;
  background: hsla(24, 20%, 50%,.08);
  background: linear-gradient(to right, hsla(24, 20%, 50%,.1) 70%, hsla(24, 20%, 50%,0));
  pointer-events: none;
  line-height: inherit;
  white-space: pre;
}

pre[data-line] .line-highlight:before, 
pre[data-line] .line-highlight[data-end]:after {
  content: attr(data-start);
  position: absolute;
  top: .4em;
  left: .6em;
  min-width: 1em;
  padding: 0 .5em;
  background-color: hsla(24, 20%, 50%,.4);
  color: hsl(24, 20%, 95%);
  font: bold 65%/1.5 sans-serif;
  text-align: center;
  vertical-align: .3em;
  border-radius: 999px;
  text-shadow: none;
  box-shadow: 0 1px white;
}

pre[data-line] .line-highlight[data-end]:after {
  content: attr(data-end);
  top: auto;
  bottom: .4em;
}.emoji {
  height: 0.8em;
}html body{font-family:"Helvetica Neue",Helvetica,"Segoe UI",Arial,freesans,sans-serif;font-size:16px;line-height:1.6;color:#333;background-color:#fff;overflow:initial;box-sizing:border-box;word-wrap:break-word}html body>:first-child{margin-top:0}html body h1,html body h2,html body h3,html body h4,html body h5,html body h6{line-height:1.2;margin-top:1em;margin-bottom:16px;color:#000}html body h1{font-size:2.25em;font-weight:300;padding-bottom:.3em}html body h2{font-size:1.75em;font-weight:400;padding-bottom:.3em}html body h3{font-size:1.5em;font-weight:500}html body h4{font-size:1.25em;font-weight:600}html body h5{font-size:1.1em;font-weight:600}html body h6{font-size:1em;font-weight:600}html body h1,html body h2,html body h3,html body h4,html body h5{font-weight:600}html body h5{font-size:1em}html body h6{color:#5c5c5c}html body strong{color:#000}html body del{color:#5c5c5c}html body a:not([href]){color:inherit;text-decoration:none}html body a{color:#08c;text-decoration:none}html body a:hover{color:#00a3f5;text-decoration:none}html body img{max-width:100%}html body>p{margin-top:0;margin-bottom:16px;word-wrap:break-word}html body>ul,html body>ol{margin-bottom:16px}html body ul,html body ol{padding-left:2em}html body ul.no-list,html body ol.no-list{padding:0;list-style-type:none}html body ul ul,html body ul ol,html body ol ol,html body ol ul{margin-top:0;margin-bottom:0}html body li{margin-bottom:0}html body li.task-list-item{list-style:none}html body li>p{margin-top:0;margin-bottom:0}html body .task-list-item-checkbox{margin:0 .2em .25em -1.8em;vertical-align:middle}html body .task-list-item-checkbox:hover{cursor:pointer}html body blockquote{margin:16px 0;font-size:inherit;padding:0 15px;color:#5c5c5c;border-left:4px solid #d6d6d6}html body blockquote>:first-child{margin-top:0}html body blockquote>:last-child{margin-bottom:0}html body hr{height:4px;margin:32px 0;background-color:#d6d6d6;border:0 none}html body table{margin:10px 0 15px 0;border-collapse:collapse;border-spacing:0;display:block;width:100%;overflow:auto;word-break:normal;word-break:keep-all}html body table th{font-weight:bold;color:#000}html body table td,html body table th{border:1px solid #d6d6d6;padding:6px 13px}html body dl{padding:0}html body dl dt{padding:0;margin-top:16px;font-size:1em;font-style:italic;font-weight:bold}html body dl dd{padding:0 16px;margin-bottom:16px}html body code{font-family:Menlo,Monaco,Consolas,'Courier New',monospace;font-size:.85em !important;color:#000;background-color:#f0f0f0;border-radius:3px;padding:.2em 0}html body code::before,html body code::after{letter-spacing:-0.2em;content:"\00a0"}html body pre>code{padding:0;margin:0;font-size:.85em !important;word-break:normal;white-space:pre;background:transparent;border:0}html body .highlight{margin-bottom:16px}html body .highlight pre,html body pre{padding:1em;overflow:auto;font-size:.85em !important;line-height:1.45;border:#d6d6d6;border-radius:3px}html body .highlight pre{margin-bottom:0;word-break:normal}html body pre code,html body pre tt{display:inline;max-width:initial;padding:0;margin:0;overflow:initial;line-height:inherit;word-wrap:normal;background-color:transparent;border:0}html body pre code:before,html body pre tt:before,html body pre code:after,html body pre tt:after{content:normal}html body p,html body blockquote,html body ul,html body ol,html body dl,html body pre{margin-top:0;margin-bottom:16px}html body kbd{color:#000;border:1px solid #d6d6d6;border-bottom:2px solid #c7c7c7;padding:2px 4px;background-color:#f0f0f0;border-radius:3px}@media print{html body{background-color:#fff}html body h1,html body h2,html body h3,html body h4,html body h5,html body h6{color:#000;page-break-after:avoid}html body blockquote{color:#5c5c5c}html body pre{page-break-inside:avoid}html body table{display:table}html body img{display:block;max-width:100%;max-height:100%}html body pre,html body code{word-wrap:break-word;white-space:pre}}
    /* Please visit the URL below for more information: */
/*   https://shd101wyy.github.io/markdown-preview-enhanced/#/customize-css */

    </style>
    
  </head>
  <body for="html-export">
    <div class="mume markdown-preview">
    <html><head></head><body><div><h1 class="mume-header" id="%E7%BD%91%E7%BB%9C%E5%A4%84%E7%90%86" ebook-toc-level-1 heading="&amp;#x7F51;&amp;#x7EDC;&amp;#x5904;&amp;#x7406;">&#x7F51;&#x7EDC;&#x5904;&#x7406;</h1>

<h2 class="mume-header" id="1-%E5%B8%B8%E8%A7%84%E6%AD%A5%E9%AA%A4" ebook-toc-level-2 heading="1. &amp;#x5E38;&amp;#x89C4;&amp;#x6B65;&amp;#x9AA4;">1. &#x5E38;&#x89C4;&#x6B65;&#x9AA4;</h2>

<h3 class="mume-header" id="11-add" ebook-toc-level-3 heading="1.1. add">1.1. add</h3>

<hr>
<p style="text-align: center;"><strong>&#x7B2C;&#x4E00;&#x6B65;&#xFF1A;&#x6DFB;&#x52A0;&#x7F51;&#x7EDC;</strong></p>
<p>&#x2003;&#x2003;&#x5F53;&#x5317;&#x5411;&#x521B;&#x5EFA;&#x7F51;&#x7EDC;api&#x88AB;&#x8C03;&#x7528;&#xFF0C;neutron&#x5199;&#x5165;config neutron/network/network&#x5E93;&#xFF0C;&#x5E76;&#x89E6;&#x53D1;datastore&#x76D1;&#x542C;&#x3002;</p>
<ul>
<li><strong>neutronVpn/NeutronNetworkChangeListener:</strong> &#x5728;&#x8FDB;&#x884C;&#x4E00;&#x4E9B;&#x57FA;&#x7840;&#x68C0;&#x67E5;&#x540E;&#xFF0C;&#x521B;&#x5EFA;elanInstance&#xFF08;&#x4E00;&#x4E2A;&#x7F51;&#x7EDC;&#x5BF9;&#x5E94;&#x4E00;&#x4E2A;elan instance&#xFF09;&#x3002;&#x521B;&#x5EFA;elanInstance&#x65F6;&#x4F1A;&#x67E5;&#x8BE2;config elan-instances/elan-instance&#x5E93;&#xFF0C;&#x5982;&#x679C;&#x5B58;&#x5728;&#xFF0C;&#x5219;&#x8FD4;&#x56DE;&#xFF0C;&#x5982;&#x679C;&#x4E0D;&#x5B58;&#x5728;&#x5219;&#x521B;&#x5EFA;enlanInstace&#x6570;&#x636E;&#xFF0C;&#x5199;&#x5165;config&#x5E93;</li>
</ul>
<br>  
<ul>
<li><strong>ipv6Service/NeutronNetworkChangeListener:</strong></li>
</ul>
<br>
<ul>
<li><strong>qosservice/QosNeutronNetworkChangeListener:</strong></li>
</ul>
<br>
<p><!--?xml version="1.0" encoding="UTF-8" standalone="no"?--><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" contentscripttype="application/ecmascript" contentstyletype="text/css" height="702px" preserveAspectRatio="none" style="width:765px;height:702px;" version="1.1" viewBox="0 0 765 702" width="765px" zoomAndPan="magnify"><defs><filter height="300%" id="fx29ivve6lvj1" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><text fill="#000000" font-family="sans-serif" font-size="18" lengthAdjust="spacingAndGlyphs" textLength="144" x="309.875" y="30.6279">&#x7B2C;&#x4E00;&#x6B65;&#xFF1A;&#x7F51;&#x7EDC;&#x521B;&#x5EFA;</text><ellipse cx="378.5" cy="44.583" fill="#000000" filter="url(#fx29ivve6lvj1)" rx="10" ry="10" style="stroke: none; stroke-width: 1.0;"/><rect fill="#99FF99" filter="url(#fx29ivve6lvj1)" height="36.3887" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="154" x="301.5" y="74.583"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="134" x="311.5" y="98.335">neutron/network/network</text><rect fill="#FEFECE" filter="url(#fx29ivve6lvj1)" height="36.3887" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="41" x="358" y="130.9717"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="21" x="368" y="154.7236">add</text><rect fill="#000000" filter="url(#fx29ivve6lvj1)" height="6" rx="2.5" ry="2.5" style="stroke: #000000; stroke-width: 1.0;" width="744.75" x="10" y="187.3604"/><rect fill="#FEFECE" filter="url(#fx29ivve6lvj1)" height="36.3887" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="124" x="99.5" y="213.3604"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="104" x="109.5" y="237.1123">bundle:neutronVpn</text><rect fill="#FEFECE" filter="url(#fx29ivve6lvj1)" height="36.3887" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="198" x="62.5" y="269.749"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="178" x="72.5" y="293.501">NeutronNetworkChangeListener</text><rect fill="#FEFECE" filter="url(#fx29ivve6lvj1)" height="36.3887" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="126" x="98.5" y="326.1377"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="106" x="108.5" y="349.8896">createElanInstance</text><rect fill="#99FF99" filter="url(#fx29ivve6lvj1)" height="36.3887" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="180" x="71.5" y="397.5264"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="160" x="81.5" y="421.2783">elan-instances/elan-instance</text><polygon fill="#FEFECE" filter="url(#fx29ivve6lvj1)" points="85,468.915,238,468.915,250,480.915,238,492.915,85,492.915,73,480.915,85,468.915" style="stroke: #A80036; stroke-width: 1.5;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="153" x="85" y="486.0095">readDs ElanInstance isPresent?</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="18" x="55" y="478.498">yes</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="12" x="250" y="478.498">no</text><rect fill="#FEFECE" filter="url(#fx29ivve6lvj1)" height="36.3887" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="82" x="22" y="502.915"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="62" x="32" y="526.667">get from ds</text><rect fill="#FEFECE" filter="url(#fx29ivve6lvj1)" height="36.3887" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="63" x="228.5" y="502.915"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="43" x="238.5" y="526.667">write ds</text><polygon fill="#FEFECE" filter="url(#fx29ivve6lvj1)" points="161.5,545.3037,173.5,557.3037,161.5,569.3037,149.5,557.3037,161.5,545.3037" style="stroke: #A80036; stroke-width: 1.5;"/><rect fill="#FEFECE" filter="url(#fx29ivve6lvj1)" height="36.3887" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="92" x="115.5" y="589.3037"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="72" x="125.5" y="613.0557">&#x5916;&#x90E8;&#x7F51;&#x7EDC;&#x5904;&#x7406;</text><rect fill="#FEFECE" filter="url(#fx29ivve6lvj1)" height="36.3887" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="123" x="351.25" y="358.1377"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="103" x="361.25" y="381.8896">bundle:ipv6Service</text><rect fill="#FEFECE" filter="url(#fx29ivve6lvj1)" height="36.3887" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="198" x="313.75" y="429.5264"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="178" x="323.75" y="453.2783">NeutronNetworkChangeListener</text><rect fill="#FEFECE" filter="url(#fx29ivve6lvj1)" height="36.3887" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="121" x="571.75" y="358.1377"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="101" x="581.75" y="381.8896">bundle:qosservice</text><rect fill="#FEFECE" filter="url(#fx29ivve6lvj1)" height="36.3887" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="221" x="521.75" y="429.5264"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="201" x="531.75" y="453.2783">QosNeutronNetworkChangeListener</text><rect fill="#000000" filter="url(#fx29ivve6lvj1)" height="6" rx="2.5" ry="2.5" style="stroke: #000000; stroke-width: 1.0;" width="744.75" x="10" y="645.6924"/><ellipse cx="378.5" cy="681.6924" fill="#FFFFFF" filter="url(#fx29ivve6lvj1)" rx="10" ry="10" style="stroke: #000000; stroke-width: 1.5;"/><line style="stroke: #000000; stroke-width: 2.5;" x1="372.3128" x2="384.6872" y1="675.5052" y2="687.8796"/><line style="stroke: #000000; stroke-width: 2.5;" x1="384.6872" x2="372.3128" y1="675.5052" y2="687.8796"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="378.5" x2="378.5" y1="54.583" y2="74.583"/><polygon fill="#A80036" points="374.5,64.583,378.5,74.583,382.5,64.583,378.5,68.583" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="378.5" x2="378.5" y1="110.9717" y2="130.9717"/><polygon fill="#A80036" points="374.5,120.9717,378.5,130.9717,382.5,120.9717,378.5,124.9717" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="161.5" x2="161.5" y1="249.749" y2="269.749"/><polygon fill="#A80036" points="157.5,259.749,161.5,269.749,165.5,259.749,161.5,263.749" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="161.5" x2="161.5" y1="306.1377" y2="326.1377"/><polygon fill="#A80036" points="157.5,316.1377,161.5,326.1377,165.5,316.1377,161.5,320.1377" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="161.5" x2="161.5" y1="362.5264" y2="397.5264"/><polygon fill="#A80036" points="157.5,387.5264,161.5,397.5264,165.5,387.5264,161.5,391.5264" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="73" x2="63" y1="480.915" y2="480.915"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="63" x2="63" y1="480.915" y2="502.915"/><polygon fill="#A80036" points="59,492.915,63,502.915,67,492.915,63,496.915" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="250" x2="260" y1="480.915" y2="480.915"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="260" x2="260" y1="480.915" y2="502.915"/><polygon fill="#A80036" points="256,492.915,260,502.915,264,492.915,260,496.915" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="63" x2="63" y1="539.3037" y2="557.3037"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="63" x2="149.5" y1="557.3037" y2="557.3037"/><polygon fill="#A80036" points="139.5,553.3037,149.5,557.3037,139.5,561.3037,143.5,557.3037" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="260" x2="260" y1="539.3037" y2="557.3037"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="260" x2="173.5" y1="557.3037" y2="557.3037"/><polygon fill="#A80036" points="183.5,553.3037,173.5,557.3037,183.5,561.3037,179.5,557.3037" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="161.5" x2="161.5" y1="433.915" y2="468.915"/><polygon fill="#A80036" points="157.5,458.915,161.5,468.915,165.5,458.915,161.5,462.915" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="161.5" x2="161.5" y1="569.3037" y2="589.3037"/><polygon fill="#A80036" points="157.5,579.3037,161.5,589.3037,165.5,579.3037,161.5,583.3037" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="412.75" x2="412.75" y1="394.5264" y2="429.5264"/><polygon fill="#A80036" points="408.75,419.5264,412.75,429.5264,416.75,419.5264,412.75,423.5264" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="632.25" x2="632.25" y1="394.5264" y2="429.5264"/><polygon fill="#A80036" points="628.25,419.5264,632.25,429.5264,636.25,419.5264,632.25,423.5264" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="161.5" x2="161.5" y1="193.3604" y2="213.3604"/><polygon fill="#A80036" points="157.5,203.3604,161.5,213.3604,165.5,203.3604,161.5,207.3604" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="412.75" x2="412.75" y1="193.3604" y2="358.1377"/><polygon fill="#A80036" points="408.75,348.1377,412.75,358.1377,416.75,348.1377,412.75,352.1377" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="632.25" x2="632.25" y1="193.3604" y2="358.1377"/><polygon fill="#A80036" points="628.25,348.1377,632.25,358.1377,636.25,348.1377,632.25,352.1377" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="161.5" x2="161.5" y1="625.6924" y2="645.6924"/><polygon fill="#A80036" points="157.5,635.6924,161.5,645.6924,165.5,635.6924,161.5,639.6924" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="412.75" x2="412.75" y1="465.915" y2="645.6924"/><polygon fill="#A80036" points="408.75,635.6924,412.75,645.6924,416.75,635.6924,412.75,639.6924" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="632.25" x2="632.25" y1="465.915" y2="645.6924"/><polygon fill="#A80036" points="628.25,635.6924,632.25,645.6924,636.25,635.6924,632.25,639.6924" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="378.5" x2="378.5" y1="167.3604" y2="187.3604"/><polygon fill="#A80036" points="374.5,177.3604,378.5,187.3604,382.5,177.3604,378.5,181.3604" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="378.5" x2="378.5" y1="651.6924" y2="671.6924"/><polygon fill="#A80036" points="374.5,661.6924,378.5,671.6924,382.5,661.6924,378.5,665.6924" style="stroke: #A80036; stroke-width: 1.0;"/><!--
@startuml
title 第一步：网络创建
start
    #99FF99:neutron/network/network;
    :add; 
    fork
        :bundle:neutronVpn; 
        :NeutronNetworkChangeListener;
        :createElanInstance;
        #99FF99:elan-instances/elan-instance;
        if (readDs ElanInstance isPresent?) then (yes)
            :get from ds; 
        else (no)
            :write ds;
        endif
        :外部网络处理; 
    fork again
        :bundle:ipv6Service;
        :NeutronNetworkChangeListener;
    fork again
        :bundle:qosservice;
        :QosNeutronNetworkChangeListener;
    end fork
    
end

@enduml

PlantUML version 1.2019.07(Tue Jun 25 03:59:20 CST 2019)
(MIT source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) 64-Bit Server VM
Java Version: 1.8.0_191-b12
Operating System: Windows 10
OS Version: 10.0
Default Encoding: GBK
Language: zh
Country: CN
--></g></svg></p><hr>
<p style="text-align: center;"><strong>&#x7B2C;&#x4E8C;&#x6B65;&#xFF1A;&#x521B;&#x5EFA;elan</strong></p>
<p>&#x2003;&#x2003;&#x5F53;elan-instances/elan-instance config&#x5E93;&#x88AB;&#x5199;&#x5165;&#x6570;&#x636E;&#x540E;&#xFF0C;&#x5F00;&#x59CB;&#x89E6;&#x53D1;elan&#x521B;&#x5EFA;&#x7684;&#x6D41;&#x7A0B;&#x3002;&#x5728;&#x521B;&#x5EFA;elan&#x7684;&#x8FC7;&#x7A0B;&#x4E2D;&#xFF0C;&#x4F1A;&#x5199;&#x5165;&#x5176;&#x4ED6;&#x7684;&#x591A;&#x4E2A;operational&#x6570;&#x636E;&#x5E93;&#xFF0C;&#x4E0D;&#x8FC7;&#x8FD9;&#x4E9B;&#x6570;&#x636E;&#x5E93;&#x90FD;&#x6CA1;&#x6709;&#x76D1;&#x542C;&#x5668;&#xFF0C;&#x4EC5;&#x4EC5;&#x4F5C;&#x4E3A;&#x6570;&#x636E;&#x5B58;&#x50A8;&#x6240;&#x7528;&#x3002;<br>
&#x2003;&#x2003;&#x521B;&#x5EFA;elan-instances/elan-instance&#x65F6;&#x8FD8;&#x4F1A;&#x66F4;&#x65B0;elan-instances/elan-instance config&#x5E93;</p>
<p><!--?xml version="1.0" encoding="UTF-8" standalone="no"?--><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" contentscripttype="application/ecmascript" contentstyletype="text/css" height="478px" preserveAspectRatio="none" style="width:752px;height:478px;" version="1.1" viewBox="0 0 752 478" width="752px" zoomAndPan="magnify"><defs><filter height="300%" id="fbm80frqkof7k" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><text fill="#000000" font-family="sans-serif" font-size="18" lengthAdjust="spacingAndGlyphs" textLength="142" x="304" y="30.6279">&#x7B2C;&#x4E8C;&#x6B65;&#xFF1A;elan&#x521B;&#x5EFA;</text><ellipse cx="365.5" cy="44.583" fill="#000000" filter="url(#fbm80frqkof7k)" rx="10" ry="10" style="stroke: none; stroke-width: 1.0;"/><rect fill="#99FF99" filter="url(#fbm80frqkof7k)" height="36.3887" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="180" x="275.5" y="74.583"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="160" x="285.5" y="98.335">elan-instances/elan-instance</text><rect fill="#FEFECE" filter="url(#fbm80frqkof7k)" height="36.3887" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="41" x="345" y="130.9717"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="21" x="355" y="154.7236">add</text><rect fill="#000000" filter="url(#fbm80frqkof7k)" height="6" rx="2.5" ry="2.5" style="stroke: #000000; stroke-width: 1.0;" width="731" x="10" y="187.3604"/><rect fill="#FEFECE" filter="url(#fbm80frqkof7k)" height="36.3887" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="160" x="87.5" y="213.3604"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="140" x="97.5" y="237.1123">ElanInstanceDpnListener</text><polygon fill="#FEFECE" filter="url(#fbm80frqkof7k)" points="120,284.749,215,284.749,227,296.749,215,308.749,120,308.749,108,296.749,120,284.749" style="stroke: #A80036; stroke-width: 1.5;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="95" x="120" y="301.8435">&#x975E;&#x5916;&#x90E8;&#x7F51;&#x7EDC; &amp;&amp; vlan</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="18" x="90" y="294.332">yes</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="12" x="227" y="294.332">no</text><rect fill="#FEFECE" filter="url(#fbm80frqkof7k)" height="52.7773" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="152" x="22" y="318.749"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="98" x="32" y="342.501">&#x521B;&#x5EFA;elan interface</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="132" x="32" y="358.8896">&#xFF08;&#x8FDE;&#x63A5;&#x5230;&#x4E1A;&#x52A1;&#x7F51;&#x7EDC;&#x63A5;&#x53E3;&#xFF09;</text><rect fill="#FEFECE" filter="url(#fbm80frqkof7k)" height="36.3887" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="52" x="211" y="318.749"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="32" x="221" y="342.501">return</text><polygon fill="#FEFECE" filter="url(#fbm80frqkof7k)" points="167.5,377.5264,179.5,389.5264,167.5,401.5264,155.5,389.5264,167.5,377.5264" style="stroke: #A80036; stroke-width: 1.5;"/><rect fill="#FEFECE" filter="url(#fbm80frqkof7k)" height="36.3887" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="164" x="273" y="260.749"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="144" x="283" y="284.501">EvpnElanInstanceListener</text><ellipse cx="355" cy="343.1377" fill="#FFFFFF" filter="url(#fbm80frqkof7k)" rx="11" ry="11" style="stroke: #000000; stroke-width: 1.0;"/><ellipse cx="355" cy="343.1377" fill="#000000" rx="6" ry="6" style="stroke: #7F7F7F; stroke-width: 1.0;"/><rect fill="#FEFECE" filter="url(#fbm80frqkof7k)" height="36.3887" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="117" x="465" y="253.5547"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="97" x="475" y="277.3066">DataObjectCache</text><rect fill="#FEFECE" filter="url(#fbm80frqkof7k)" height="36.3887" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="68" x="489.5" y="324.9434"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="48" x="499.5" y="348.6953">&#x6DFB;&#x52A0;&#x7F13;&#x5B58;</text><rect fill="#FEFECE" filter="url(#fbm80frqkof7k)" height="36.3887" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="137" x="592" y="260.749"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="117" x="602" y="284.501">ElanInstanceListener</text><ellipse cx="660.5" cy="343.1377" fill="#FFFFFF" filter="url(#fbm80frqkof7k)" rx="11" ry="11" style="stroke: #000000; stroke-width: 1.0;"/><ellipse cx="660.5" cy="343.1377" fill="#000000" rx="6" ry="6" style="stroke: #7F7F7F; stroke-width: 1.0;"/><rect fill="#000000" filter="url(#fbm80frqkof7k)" height="6" rx="2.5" ry="2.5" style="stroke: #000000; stroke-width: 1.0;" width="731" x="10" y="421.5264"/><ellipse cx="365.5" cy="457.5264" fill="#FFFFFF" filter="url(#fbm80frqkof7k)" rx="10" ry="10" style="stroke: #000000; stroke-width: 1.5;"/><line style="stroke: #000000; stroke-width: 2.5;" x1="359.3128" x2="371.6872" y1="451.3392" y2="463.7136"/><line style="stroke: #000000; stroke-width: 2.5;" x1="371.6872" x2="359.3128" y1="451.3392" y2="463.7136"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="365.5" x2="365.5" y1="54.583" y2="74.583"/><polygon fill="#A80036" points="361.5,64.583,365.5,74.583,369.5,64.583,365.5,68.583" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="365.5" x2="365.5" y1="110.9717" y2="130.9717"/><polygon fill="#A80036" points="361.5,120.9717,365.5,130.9717,369.5,120.9717,365.5,124.9717" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="108" x2="98" y1="296.749" y2="296.749"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="98" x2="98" y1="296.749" y2="318.749"/><polygon fill="#A80036" points="94,308.749,98,318.749,102,308.749,98,312.749" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="227" x2="237" y1="296.749" y2="296.749"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="237" x2="237" y1="296.749" y2="318.749"/><polygon fill="#A80036" points="233,308.749,237,318.749,241,308.749,237,312.749" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="98" x2="98" y1="371.5264" y2="389.5264"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="98" x2="155.5" y1="389.5264" y2="389.5264"/><polygon fill="#A80036" points="145.5,385.5264,155.5,389.5264,145.5,393.5264,149.5,389.5264" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="237" x2="237" y1="355.1377" y2="389.5264"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="237" x2="179.5" y1="389.5264" y2="389.5264"/><polygon fill="#A80036" points="189.5,385.5264,179.5,389.5264,189.5,393.5264,185.5,389.5264" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="167.5" x2="167.5" y1="249.749" y2="284.749"/><polygon fill="#A80036" points="163.5,274.749,167.5,284.749,171.5,274.749,167.5,278.749" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="355" x2="355" y1="297.1377" y2="332.1377"/><polygon fill="#A80036" points="351,322.1377,355,332.1377,359,322.1377,355,326.1377" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="523.5" x2="523.5" y1="289.9434" y2="324.9434"/><polygon fill="#A80036" points="519.5,314.9434,523.5,324.9434,527.5,314.9434,523.5,318.9434" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="660.5" x2="660.5" y1="297.1377" y2="332.1377"/><polygon fill="#A80036" points="656.5,322.1377,660.5,332.1377,664.5,322.1377,660.5,326.1377" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="167.5" x2="167.5" y1="193.3604" y2="213.3604"/><polygon fill="#A80036" points="163.5,203.3604,167.5,213.3604,171.5,203.3604,167.5,207.3604" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="355" x2="355" y1="193.3604" y2="260.749"/><polygon fill="#A80036" points="351,250.749,355,260.749,359,250.749,355,254.749" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="523.5" x2="523.5" y1="193.3604" y2="253.5547"/><polygon fill="#A80036" points="519.5,243.5547,523.5,253.5547,527.5,243.5547,523.5,247.5547" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="660.5" x2="660.5" y1="193.3604" y2="260.749"/><polygon fill="#A80036" points="656.5,250.749,660.5,260.749,664.5,250.749,660.5,254.749" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="167.5" x2="167.5" y1="401.5264" y2="421.5264"/><polygon fill="#A80036" points="163.5,411.5264,167.5,421.5264,171.5,411.5264,167.5,415.5264" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="523.5" x2="523.5" y1="361.332" y2="421.5264"/><polygon fill="#A80036" points="519.5,411.5264,523.5,421.5264,527.5,411.5264,523.5,415.5264" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="365.5" x2="365.5" y1="167.3604" y2="187.3604"/><polygon fill="#A80036" points="361.5,177.3604,365.5,187.3604,369.5,177.3604,365.5,181.3604" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="365.5" x2="365.5" y1="427.5264" y2="447.5264"/><polygon fill="#A80036" points="361.5,437.5264,365.5,447.5264,369.5,437.5264,365.5,441.5264" style="stroke: #A80036; stroke-width: 1.0;"/><!--
@startuml
title 第二步：elan创建
start
    #99FF99:elan-instances/elan-instance;
    :add; 
    fork
        :ElanInstanceDpnListener; 
        if (非外部网络 && vlan) then (yes)
            :创建elan interface \n（连接到业务网络接口）; 
        else (no)
            :return;
        endif
    fork again
        :EvpnElanInstanceListener;
        stop;
    fork again
        :DataObjectCache;
        :添加缓存;
    fork again
        :ElanInstanceListener;
        stop;  
    end fork
    
end

@enduml

PlantUML version 1.2019.07(Tue Jun 25 03:59:20 CST 2019)
(MIT source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) 64-Bit Server VM
Java Version: 1.8.0_191-b12
Operating System: Windows 10
OS Version: 10.0
Default Encoding: GBK
Language: zh
Country: CN
--></g></svg></p><p>&#x2003;&#x2003;<strong>&#x63A5;&#x4E0B;&#x56FE;</strong></p>
<p><!--?xml version="1.0" encoding="UTF-8" standalone="no"?--><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" contentscripttype="application/ecmascript" contentstyletype="text/css" height="577px" preserveAspectRatio="none" style="width:1058px;height:577px;" version="1.1" viewBox="0 0 1058 577" width="1058px" zoomAndPan="magnify"><defs><filter height="300%" id="f4hnwm37lyf3m" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><text fill="#000000" font-family="sans-serif" font-size="18" lengthAdjust="spacingAndGlyphs" textLength="160" x="448" y="30.6279">&#x7B2C;&#x4E8C;&#x6B65;&#xFF1A;elan&#x521B;&#x5EFA;&#x7EED;</text><ellipse cx="514" cy="44.583" fill="#000000" filter="url(#f4hnwm37lyf3m)" rx="10" ry="10" style="stroke: none; stroke-width: 1.0;"/><rect fill="#99FF99" filter="url(#f4hnwm37lyf3m)" height="36.3887" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="180" x="424" y="74.583"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="160" x="434" y="98.335">elan-instances/elan-instance</text><rect fill="#FEFECE" filter="url(#f4hnwm37lyf3m)" height="36.3887" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="41" x="493.5" y="130.9717"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="21" x="503.5" y="154.7236">add</text><rect fill="#000000" filter="url(#f4hnwm37lyf3m)" height="6" rx="2.5" ry="2.5" style="stroke: #000000; stroke-width: 1.0;" width="1037" x="10" y="187.3604"/><rect fill="#FEFECE" filter="url(#f4hnwm37lyf3m)" height="36.3887" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="29" x="22" y="302.9434"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="9" x="32" y="326.6953">...</text><ellipse cx="36.5" cy="385.332" fill="#FFFFFF" filter="url(#f4hnwm37lyf3m)" rx="11" ry="11" style="stroke: #000000; stroke-width: 1.0;"/><ellipse cx="36.5" cy="385.332" fill="#000000" rx="6" ry="6" style="stroke: #7F7F7F; stroke-width: 1.0;"/><rect fill="#FEFECE" filter="url(#f4hnwm37lyf3m)" height="36.3887" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="140" x="472.5" y="213.3604"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="120" x="482.5" y="237.1123">ElanInstanceManager</text><rect fill="#FEFECE" filter="url(#f4hnwm37lyf3m)" height="36.3887" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="230" x="427.5" y="269.749"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="210" x="437.5" y="293.501">ElanUtils.updateOperationalDataStore</text><rect fill="#000000" filter="url(#f4hnwm37lyf3m)" height="6" rx="2.5" ry="2.5" style="stroke: #000000; stroke-width: 1.0;" width="974" x="61" y="341.1377"/><rect fill="#00B2EE" filter="url(#f4hnwm37lyf3m)" height="36.3887" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="102" x="73" y="402.832"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="82" x="83" y="426.584">elan:elan-state</text><rect fill="#00B2EE" filter="url(#f4hnwm37lyf3m)" height="36.3887" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="229" x="185" y="402.832"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="209" x="195" y="426.584">elan:elan-forwarding-tables/mac-table</text><rect fill="#00B2EE" filter="url(#f4hnwm37lyf3m)" height="36.3887" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="123" x="431" y="374.332"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="103" x="441" y="398.084">EtreeInstance &#x5904;&#x7406;</text><ellipse cx="492.5" cy="456.7207" fill="#FFFFFF" filter="url(#f4hnwm37lyf3m)" rx="11" ry="11" style="stroke: #000000; stroke-width: 1.0;"/><ellipse cx="492.5" cy="456.7207" fill="#000000" rx="6" ry="6" style="stroke: #7F7F7F; stroke-width: 1.0;"/><rect fill="#00B2EE" filter="url(#f4hnwm37lyf3m)" height="36.3887" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="157" x="582" y="402.832"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="137" x="592" y="426.584">elan:elan-tag-name-map</text><rect fill="#FEFECE" filter="url(#f4hnwm37lyf3m)" height="36.3887" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="58" x="857" y="367.1377"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="38" x="867" y="390.8896">update</text><rect fill="#99FF99" filter="url(#f4hnwm37lyf3m)" height="36.3887" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="274" x="749" y="438.5264"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="254" x="759" y="462.2783">elan-instances/elan-instance&#xFF08;with elanTag&#xFF09;</text><rect fill="#000000" filter="url(#f4hnwm37lyf3m)" height="6" rx="2.5" ry="2.5" style="stroke: #000000; stroke-width: 1.0;" width="974" x="61" y="494.915"/><rect fill="#000000" filter="url(#f4hnwm37lyf3m)" height="6" rx="2.5" ry="2.5" style="stroke: #000000; stroke-width: 1.0;" width="1037" x="10" y="520.915"/><ellipse cx="514" cy="556.915" fill="#FFFFFF" filter="url(#f4hnwm37lyf3m)" rx="10" ry="10" style="stroke: #000000; stroke-width: 1.5;"/><line style="stroke: #000000; stroke-width: 2.5;" x1="507.8128" x2="520.1872" y1="550.7279" y2="563.1022"/><line style="stroke: #000000; stroke-width: 2.5;" x1="520.1872" x2="507.8128" y1="550.7279" y2="563.1022"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="514" x2="514" y1="54.583" y2="74.583"/><polygon fill="#A80036" points="510,64.583,514,74.583,518,64.583,514,68.583" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="514" x2="514" y1="110.9717" y2="130.9717"/><polygon fill="#A80036" points="510,120.9717,514,130.9717,518,120.9717,514,124.9717" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="36.5" x2="36.5" y1="339.332" y2="374.332"/><polygon fill="#A80036" points="32.5,364.332,36.5,374.332,40.5,364.332,36.5,368.332" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="542.5" x2="542.5" y1="249.749" y2="269.749"/><polygon fill="#A80036" points="538.5,259.749,542.5,269.749,546.5,259.749,542.5,263.749" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="492.5" x2="492.5" y1="410.7207" y2="445.7207"/><polygon fill="#A80036" points="488.5,435.7207,492.5,445.7207,496.5,435.7207,492.5,439.7207" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="886" x2="886" y1="403.5264" y2="438.5264"/><polygon fill="#A80036" points="882,428.5264,886,438.5264,890,428.5264,886,432.5264" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="124" x2="124" y1="347.1377" y2="402.832"/><polygon fill="#A80036" points="120,392.832,124,402.832,128,392.832,124,396.832" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="299.5" x2="299.5" y1="347.1377" y2="402.832"/><polygon fill="#A80036" points="295.5,392.832,299.5,402.832,303.5,392.832,299.5,396.832" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="492.5" x2="492.5" y1="347.1377" y2="374.332"/><polygon fill="#A80036" points="488.5,364.332,492.5,374.332,496.5,364.332,492.5,368.332" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="660.5" x2="660.5" y1="347.1377" y2="402.832"/><polygon fill="#A80036" points="656.5,392.832,660.5,402.832,664.5,392.832,660.5,396.832" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="886" x2="886" y1="347.1377" y2="367.1377"/><polygon fill="#A80036" points="882,357.1377,886,367.1377,890,357.1377,886,361.1377" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="124" x2="124" y1="439.2207" y2="494.915"/><polygon fill="#A80036" points="120,484.915,124,494.915,128,484.915,124,488.915" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="299.5" x2="299.5" y1="439.2207" y2="494.915"/><polygon fill="#A80036" points="295.5,484.915,299.5,494.915,303.5,484.915,299.5,488.915" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="660.5" x2="660.5" y1="439.2207" y2="494.915"/><polygon fill="#A80036" points="656.5,484.915,660.5,494.915,664.5,484.915,660.5,488.915" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="886" x2="886" y1="474.915" y2="494.915"/><polygon fill="#A80036" points="882,484.915,886,494.915,890,484.915,886,488.915" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="542.5" x2="542.5" y1="306.1377" y2="341.1377"/><polygon fill="#A80036" points="538.5,331.1377,542.5,341.1377,546.5,331.1377,542.5,335.1377" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="36.5" x2="36.5" y1="193.3604" y2="302.9434"/><polygon fill="#A80036" points="32.5,292.9434,36.5,302.9434,40.5,292.9434,36.5,296.9434" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="542.5" x2="542.5" y1="193.3604" y2="213.3604"/><polygon fill="#A80036" points="538.5,203.3604,542.5,213.3604,546.5,203.3604,542.5,207.3604" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="542.5" x2="542.5" y1="500.915" y2="520.915"/><polygon fill="#A80036" points="538.5,510.915,542.5,520.915,546.5,510.915,542.5,514.915" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="514" x2="514" y1="167.3604" y2="187.3604"/><polygon fill="#A80036" points="510,177.3604,514,187.3604,518,177.3604,514,181.3604" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="514" x2="514" y1="526.915" y2="546.915"/><polygon fill="#A80036" points="510,536.915,514,546.915,518,536.915,514,540.915" style="stroke: #A80036; stroke-width: 1.0;"/><!--
@startuml
title 第二步：elan创建续
start
    #99FF99:elan-instances/elan-instance;
    :add; 
    fork
        :...;
        stop  
    fork again
        :ElanInstanceManager;
        :ElanUtils.updateOperationalDataStore;
        fork
        #00B2EE:elan:elan-state;
        fork again
        #00B2EE:elan:elan-forwarding-tables/mac-table;
        fork again
        #00B2EE:EtreeInstance 处理;
        stop;
        fork again
        #00B2EE:elan:elan-tag-name-map;
        fork again
        :update;
        #99FF99:elan-instances/elan-instance（with elanTag）; 
        end fork     
    end fork
   
end

@enduml

PlantUML version 1.2019.07(Tue Jun 25 03:59:20 CST 2019)
(MIT source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) 64-Bit Server VM
Java Version: 1.8.0_191-b12
Operating System: Windows 10
OS Version: 10.0
Default Encoding: GBK
Language: zh
Country: CN
--></g></svg></p><hr>
<p style="text-align: center;"><strong>&#x7B2C;&#x4E09;&#x6B65;&#xFF1A;elan &#x66F4;&#x65B0;</strong></p>
<p>&#x2003;&#x2003;&#x5F53;elan-instances/elan-instance config&#x5E93;&#x88AB;&#x66F4;&#x65B0;&#x6570;&#x636E;&#x540E;&#xFF0C;&#x5F00;&#x59CB;&#x89E6;&#x53D1;elan&#x66F4;&#x65B0;&#x7684;&#x6D41;&#x7A0B;&#x3002;</p>
<p><!--?xml version="1.0" encoding="UTF-8" standalone="no"?--><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" contentscripttype="application/ecmascript" contentstyletype="text/css" height="1072px" preserveAspectRatio="none" style="width:882px;height:1072px;" version="1.1" viewBox="0 0 882 1072" width="882px" zoomAndPan="magnify"><defs><filter height="300%" id="f9c0bb0lov01n" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><text fill="#000000" font-family="sans-serif" font-size="18" lengthAdjust="spacingAndGlyphs" textLength="147" x="366.5" y="30.6279">&#x7B2C;&#x4E09;&#x6B65;&#xFF1A;elan &#x66F4;&#x65B0;</text><ellipse cx="451.5" cy="44.583" fill="#000000" filter="url(#f9c0bb0lov01n)" rx="10" ry="10" style="stroke: none; stroke-width: 1.0;"/><rect fill="#99FF99" filter="url(#f9c0bb0lov01n)" height="36.3887" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="180" x="361.5" y="74.583"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="160" x="371.5" y="98.335">elan-instances/elan-instance</text><rect fill="#FEFECE" filter="url(#f9c0bb0lov01n)" height="36.3887" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="58" x="422.5" y="130.9717"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="38" x="432.5" y="154.7236">update</text><rect fill="#000000" filter="url(#f9c0bb0lov01n)" height="6" rx="2.5" ry="2.5" style="stroke: #000000; stroke-width: 1.0;" width="861" x="10" y="187.3604"/><rect fill="#FEFECE" filter="url(#f9c0bb0lov01n)" height="36.3887" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="160" x="104.5" y="213.3604"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="140" x="114.5" y="237.1123">ElanInstanceDpnListener</text><rect fill="#FEFECE" filter="url(#f9c0bb0lov01n)" height="52.7773" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="152" x="108.5" y="395.8867"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="98" x="118.5" y="419.6387">&#x5220;&#x9664;elan interface</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="132" x="118.5" y="436.0273">&#xFF08;&#x8FDE;&#x63A5;&#x5230;&#x4E1A;&#x52A1;&#x7F51;&#x7EDC;&#x63A5;&#x53E3;&#xFF09;</text><rect fill="#FEFECE" filter="url(#f9c0bb0lov01n)" height="52.7773" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="152" x="108.5" y="483.6641"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="98" x="118.5" y="507.416">&#x521B;&#x5EFA;elan interface</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="132" x="118.5" y="523.8047">&#xFF08;&#x8FDE;&#x63A5;&#x5230;&#x4E1A;&#x52A1;&#x7F51;&#x7EDC;&#x63A5;&#x53E3;&#xFF09;</text><polygon fill="#FEFECE" filter="url(#f9c0bb0lov01n)" points="34,325.3064,335,325.3064,347,347.8408,335,370.3752,34,370.3752,22,347.8408,34,325.3064" style="stroke: #A80036; stroke-width: 1.5;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="18" x="188.5" y="382.9812">yes</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="221" x="34" y="337.9124">before.SegmentationId != after.SegmentationId</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="298" x="37" y="352.9353">|| before.PhysicalNetworkName != after.PhysicalNetworkName</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="0" x="37" y="367.9583"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="12" x="347" y="345.4238">no</text><polygon fill="#FEFECE" filter="url(#f9c0bb0lov01n)" points="184.5,561.9529,196.5,573.9529,184.5,585.9529,172.5,573.9529,184.5,561.9529" style="stroke: #A80036; stroke-width: 1.5;"/><polygon fill="#FEFECE" filter="url(#f9c0bb0lov01n)" points="116,269.749,253,269.749,265,284.772,253,299.7949,116,299.7949,104,284.772,116,269.749" style="stroke: #A80036; stroke-width: 1.5;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="18" x="188.5" y="312.4009">yes</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="126" x="116" y="282.355">before.isVlanElanInstance</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="134" x="119" y="297.3779">&amp;&amp; after.isVlanElanInstance</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="12" x="265" y="282.355">no</text><polygon fill="#FEFECE" filter="url(#f9c0bb0lov01n)" points="184.5,611.4644,196.5,623.4644,184.5,635.4644,172.5,623.4644,184.5,611.4644" style="stroke: #A80036; stroke-width: 1.5;"/><rect fill="#FEFECE" filter="url(#f9c0bb0lov01n)" height="52.7773" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="152" x="108.5" y="726.0217"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="98" x="118.5" y="749.7737">&#x521B;&#x5EFA;elan interface</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="132" x="118.5" y="766.1624">&#xFF08;&#x8FDE;&#x63A5;&#x5230;&#x4E1A;&#x52A1;&#x7F51;&#x7EDC;&#x63A5;&#x53E3;&#xFF09;</text><polygon fill="#FEFECE" filter="url(#f9c0bb0lov01n)" points="116,670.4644,253,670.4644,265,685.4873,253,700.5103,116,700.5103,104,685.4873,116,670.4644" style="stroke: #A80036; stroke-width: 1.5;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="18" x="188.5" y="713.1162">yes</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="128" x="116" y="683.0703">!before.isVlanElanInstance</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="134" x="119" y="698.0933">&amp;&amp; after.isVlanElanInstance</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="12" x="265" y="683.0703">no</text><polygon fill="#FEFECE" filter="url(#f9c0bb0lov01n)" points="184.5,798.7991,196.5,810.7991,184.5,822.7991,172.5,810.7991,184.5,798.7991" style="stroke: #A80036; stroke-width: 1.5;"/><rect fill="#FEFECE" filter="url(#f9c0bb0lov01n)" height="52.7773" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="152" x="108.5" y="898.3564"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="74" x="118.5" y="922.1084">&#x5220;&#x9664; interface</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="132" x="118.5" y="938.4971">&#xFF08;&#x8FDE;&#x63A5;&#x5230;&#x4E1A;&#x52A1;&#x7F51;&#x7EDC;&#x63A5;&#x53E3;&#xFF09;</text><polygon fill="#FEFECE" filter="url(#f9c0bb0lov01n)" points="115,842.7991,254,842.7991,266,857.822,254,872.845,115,872.845,103,857.822,115,842.7991" style="stroke: #A80036; stroke-width: 1.5;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="18" x="188.5" y="885.4509">yes</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="126" x="115" y="855.405">before.isVlanElanInstance</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="136" x="118" y="870.428">&amp;&amp; !after.isVlanElanInstance</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="12" x="266" y="855.405">no</text><polygon fill="#FEFECE" filter="url(#f9c0bb0lov01n)" points="184.5,971.1338,196.5,983.1338,184.5,995.1338,172.5,983.1338,184.5,971.1338" style="stroke: #A80036; stroke-width: 1.5;"/><rect fill="#FEFECE" filter="url(#f9c0bb0lov01n)" height="36.3887" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="164" x="409" y="392.6526"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="144" x="419" y="416.4045">EvpnElanInstanceListener</text><rect fill="#FEFECE" filter="url(#f9c0bb0lov01n)" height="36.3887" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="96" x="443" y="513.5527"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="76" x="453" y="537.3047">do something</text><polygon fill="#FEFECE" filter="url(#f9c0bb0lov01n)" points="425,464.0413,557,464.0413,569,476.0413,557,488.0413,425,488.0413,413,476.0413,425,464.0413" style="stroke: #A80036; stroke-width: 1.5;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="18" x="495" y="500.6472">yes</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="132" x="425" y="481.1357">isWithdrawEvpnRT2Routes</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="12" x="569" y="473.6243">no</text><polygon fill="#FEFECE" filter="url(#f9c0bb0lov01n)" points="491,575.4529,503,587.4529,491,599.4529,479,587.4529,491,575.4529" style="stroke: #A80036; stroke-width: 1.5;"/><rect fill="#FEFECE" filter="url(#f9c0bb0lov01n)" height="36.3887" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="96" x="443" y="683.9644"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="76" x="453" y="707.7163">do something</text><polygon fill="#FEFECE" filter="url(#f9c0bb0lov01n)" points="425,634.4529,557,634.4529,569,646.4529,557,658.4529,425,658.4529,413,646.4529,425,634.4529" style="stroke: #A80036; stroke-width: 1.5;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="18" x="495" y="671.0588">yes</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="132" x="425" y="651.5474">isAdvertiseEvpnRT2Routes</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="12" x="569" y="644.0359">no</text><polygon fill="#FEFECE" filter="url(#f9c0bb0lov01n)" points="491,745.8645,503,757.8645,491,769.8645,479,757.8645,491,745.8645" style="stroke: #A80036; stroke-width: 1.5;"/><ellipse cx="491" cy="810.353" fill="#FFFFFF" filter="url(#f9c0bb0lov01n)" rx="11" ry="11" style="stroke: #000000; stroke-width: 1.0;"/><ellipse cx="491" cy="810.353" fill="#000000" rx="6" ry="6" style="stroke: #7F7F7F; stroke-width: 1.0;"/><rect fill="#FEFECE" filter="url(#f9c0bb0lov01n)" height="36.3887" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="117" x="595" y="555.8699"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="97" x="605" y="579.6218">DataObjectCache</text><rect fill="#FEFECE" filter="url(#f9c0bb0lov01n)" height="36.3887" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="68" x="619.5" y="627.2585"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="48" x="629.5" y="651.0105">&#x5904;&#x7406;&#x7F13;&#x5B58;</text><rect fill="#FEFECE" filter="url(#f9c0bb0lov01n)" height="36.3887" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="137" x="722" y="563.0642"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="117" x="732" y="586.8162">ElanInstanceListener</text><ellipse cx="790.5" cy="645.4529" fill="#FFFFFF" filter="url(#f9c0bb0lov01n)" rx="11" ry="11" style="stroke: #000000; stroke-width: 1.0;"/><ellipse cx="790.5" cy="645.4529" fill="#000000" rx="6" ry="6" style="stroke: #7F7F7F; stroke-width: 1.0;"/><rect fill="#000000" filter="url(#f9c0bb0lov01n)" height="6" rx="2.5" ry="2.5" style="stroke: #000000; stroke-width: 1.0;" width="861" x="10" y="1015.1338"/><ellipse cx="451.5" cy="1051.1338" fill="#FFFFFF" filter="url(#f9c0bb0lov01n)" rx="10" ry="10" style="stroke: #000000; stroke-width: 1.5;"/><line style="stroke: #000000; stroke-width: 2.5;" x1="445.3128" x2="457.6872" y1="1044.9466" y2="1057.321"/><line style="stroke: #000000; stroke-width: 2.5;" x1="457.6872" x2="445.3128" y1="1044.9466" y2="1057.321"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="451.5" x2="451.5" y1="54.583" y2="74.583"/><polygon fill="#A80036" points="447.5,64.583,451.5,74.583,455.5,64.583,451.5,68.583" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="451.5" x2="451.5" y1="110.9717" y2="130.9717"/><polygon fill="#A80036" points="447.5,120.9717,451.5,130.9717,455.5,120.9717,451.5,124.9717" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="184.5" x2="184.5" y1="448.6641" y2="483.6641"/><polygon fill="#A80036" points="180.5,473.6641,184.5,483.6641,188.5,473.6641,184.5,477.6641" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="184.5" x2="184.5" y1="370.3752" y2="395.8867"/><polygon fill="#A80036" points="180.5,385.8867,184.5,395.8867,188.5,385.8867,184.5,389.8867" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="347" x2="359" y1="347.8408" y2="347.8408"/><polygon fill="#A80036" points="355,450.8969,359,460.8969,363,450.8969,359,454.8969" style="stroke: #A80036; stroke-width: 1.5;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="359" x2="359" y1="347.8408" y2="573.9529"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="359" x2="196.5" y1="573.9529" y2="573.9529"/><polygon fill="#A80036" points="206.5,569.9529,196.5,573.9529,206.5,577.9529,202.5,573.9529" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="184.5" x2="184.5" y1="536.4414" y2="561.9529"/><polygon fill="#A80036" points="180.5,551.9529,184.5,561.9529,188.5,551.9529,184.5,555.9529" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="184.5" x2="184.5" y1="299.7949" y2="325.3064"/><polygon fill="#A80036" points="180.5,315.3064,184.5,325.3064,188.5,315.3064,184.5,319.3064" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="265" x2="369" y1="284.772" y2="284.772"/><polygon fill="#A80036" points="365,444.1182,369,454.1182,373,444.1182,369,448.1182" style="stroke: #A80036; stroke-width: 1.5;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="369" x2="369" y1="284.772" y2="623.4644"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="369" x2="196.5" y1="623.4644" y2="623.4644"/><polygon fill="#A80036" points="206.5,619.4644,196.5,623.4644,206.5,627.4644,202.5,623.4644" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="184.5" x2="184.5" y1="585.9529" y2="611.4644"/><polygon fill="#A80036" points="180.5,601.4644,184.5,611.4644,188.5,601.4644,184.5,605.4644" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="184.5" x2="184.5" y1="249.749" y2="269.749"/><polygon fill="#A80036" points="180.5,259.749,184.5,269.749,188.5,259.749,184.5,263.749" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="184.5" x2="184.5" y1="700.5103" y2="726.0217"/><polygon fill="#A80036" points="180.5,716.0217,184.5,726.0217,188.5,716.0217,184.5,720.0217" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="265" x2="277" y1="685.4873" y2="685.4873"/><polygon fill="#A80036" points="273,740.8989,277,750.8989,281,740.8989,277,744.8989" style="stroke: #A80036; stroke-width: 1.5;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="277" x2="277" y1="685.4873" y2="810.7991"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="277" x2="196.5" y1="810.7991" y2="810.7991"/><polygon fill="#A80036" points="206.5,806.7991,196.5,810.7991,206.5,814.7991,202.5,810.7991" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="184.5" x2="184.5" y1="778.7991" y2="798.7991"/><polygon fill="#A80036" points="180.5,788.7991,184.5,798.7991,188.5,788.7991,184.5,792.7991" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="184.5" x2="184.5" y1="635.4644" y2="670.4644"/><polygon fill="#A80036" points="180.5,660.4644,184.5,670.4644,188.5,660.4644,184.5,664.4644" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="184.5" x2="184.5" y1="872.845" y2="898.3564"/><polygon fill="#A80036" points="180.5,888.3564,184.5,898.3564,188.5,888.3564,184.5,892.3564" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="266" x2="278" y1="857.822" y2="857.822"/><polygon fill="#A80036" points="274,913.2336,278,923.2336,282,913.2336,278,917.2336" style="stroke: #A80036; stroke-width: 1.5;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="278" x2="278" y1="857.822" y2="983.1338"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="278" x2="196.5" y1="983.1338" y2="983.1338"/><polygon fill="#A80036" points="206.5,979.1338,196.5,983.1338,206.5,987.1338,202.5,983.1338" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="184.5" x2="184.5" y1="951.1338" y2="971.1338"/><polygon fill="#A80036" points="180.5,961.1338,184.5,971.1338,188.5,961.1338,184.5,965.1338" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="184.5" x2="184.5" y1="822.7991" y2="842.7991"/><polygon fill="#A80036" points="180.5,832.7991,184.5,842.7991,188.5,832.7991,184.5,836.7991" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="491" x2="491" y1="488.0413" y2="513.5527"/><polygon fill="#A80036" points="487,503.5527,491,513.5527,495,503.5527,491,507.5527" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="569" x2="581" y1="476.0413" y2="476.0413"/><polygon fill="#A80036" points="577,521.7471,581,531.7471,585,521.7471,581,525.7471" style="stroke: #A80036; stroke-width: 1.5;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="581" x2="581" y1="476.0413" y2="587.4529"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="581" x2="503" y1="587.4529" y2="587.4529"/><polygon fill="#A80036" points="513,583.4529,503,587.4529,513,591.4529,509,587.4529" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="491" x2="491" y1="549.9414" y2="575.4529"/><polygon fill="#A80036" points="487,565.4529,491,575.4529,495,565.4529,491,569.4529" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="491" x2="491" y1="429.0413" y2="464.0413"/><polygon fill="#A80036" points="487,454.0413,491,464.0413,495,454.0413,491,458.0413" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="491" x2="491" y1="658.4529" y2="683.9644"/><polygon fill="#A80036" points="487,673.9644,491,683.9644,495,673.9644,491,677.9644" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="569" x2="581" y1="646.4529" y2="646.4529"/><polygon fill="#A80036" points="577,692.1587,581,702.1587,585,692.1587,581,696.1587" style="stroke: #A80036; stroke-width: 1.5;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="581" x2="581" y1="646.4529" y2="757.8645"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="581" x2="503" y1="757.8645" y2="757.8645"/><polygon fill="#A80036" points="513,753.8645,503,757.8645,513,761.8645,509,757.8645" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="491" x2="491" y1="720.353" y2="745.8645"/><polygon fill="#A80036" points="487,735.8645,491,745.8645,495,735.8645,491,739.8645" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="491" x2="491" y1="599.4529" y2="634.4529"/><polygon fill="#A80036" points="487,624.4529,491,634.4529,495,624.4529,491,628.4529" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="491" x2="491" y1="769.8645" y2="799.353"/><polygon fill="#A80036" points="487,789.353,491,799.353,495,789.353,491,793.353" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="653.5" x2="653.5" y1="592.2585" y2="627.2585"/><polygon fill="#A80036" points="649.5,617.2585,653.5,627.2585,657.5,617.2585,653.5,621.2585" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="790.5" x2="790.5" y1="599.4529" y2="634.4529"/><polygon fill="#A80036" points="786.5,624.4529,790.5,634.4529,794.5,624.4529,790.5,628.4529" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="184.5" x2="184.5" y1="193.3604" y2="213.3604"/><polygon fill="#A80036" points="180.5,203.3604,184.5,213.3604,188.5,203.3604,184.5,207.3604" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="491" x2="491" y1="193.3604" y2="392.6526"/><polygon fill="#A80036" points="487,382.6526,491,392.6526,495,382.6526,491,386.6526" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="653.5" x2="653.5" y1="193.3604" y2="555.8699"/><polygon fill="#A80036" points="649.5,545.8699,653.5,555.8699,657.5,545.8699,653.5,549.8699" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="790.5" x2="790.5" y1="193.3604" y2="563.0642"/><polygon fill="#A80036" points="786.5,553.0642,790.5,563.0642,794.5,553.0642,790.5,557.0642" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="184.5" x2="184.5" y1="995.1338" y2="1015.1338"/><polygon fill="#A80036" points="180.5,1005.1338,184.5,1015.1338,188.5,1005.1338,184.5,1009.1338" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="653.5" x2="653.5" y1="663.6472" y2="1015.1338"/><polygon fill="#A80036" points="649.5,1005.1338,653.5,1015.1338,657.5,1005.1338,653.5,1009.1338" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="451.5" x2="451.5" y1="167.3604" y2="187.3604"/><polygon fill="#A80036" points="447.5,177.3604,451.5,187.3604,455.5,177.3604,451.5,181.3604" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="451.5" x2="451.5" y1="1021.1338" y2="1041.1338"/><polygon fill="#A80036" points="447.5,1031.1338,451.5,1041.1338,455.5,1031.1338,451.5,1035.1338" style="stroke: #A80036; stroke-width: 1.0;"/><!--
@startuml
title 第三步：elan 更新
start
    #99FF99:elan-instances/elan-instance;
    :update; 
    fork
        :ElanInstanceDpnListener; 
        if (before.isVlanElanInstance \n && after.isVlanElanInstance) then (yes)
            if (before.SegmentationId != after.SegmentationId\n || before.PhysicalNetworkName != after.PhysicalNetworkName\n) then (yes)    
            :删除elan interface \n（连接到业务网络接口）; 
            :创建elan interface \n（连接到业务网络接口）;
            else(no) 
            endif 
        else(no) 
        endif

        if (!before.isVlanElanInstance \n && after.isVlanElanInstance) then (yes)
            :创建elan interface \n（连接到业务网络接口）;
        else(no) 
        endif

        if (before.isVlanElanInstance \n && !after.isVlanElanInstance) then (yes)
            :删除 interface \n（连接到业务网络接口）;
        else(no) 
        endif

    fork again
        :EvpnElanInstanceListener;
        if (isWithdrawEvpnRT2Routes) then (yes)
            :do something;
        else(no)
        endif
        if (isAdvertiseEvpnRT2Routes) then (yes)
            :do something;
        else(no)
        endif
        stop;
    fork again
        :DataObjectCache;
        :处理缓存;
    fork again
        :ElanInstanceListener;
        stop;  
    end fork
    
end

@enduml

PlantUML version 1.2019.07(Tue Jun 25 03:59:20 CST 2019)
(MIT source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) 64-Bit Server VM
Java Version: 1.8.0_191-b12
Operating System: Windows 10
OS Version: 10.0
Default Encoding: GBK
Language: zh
Country: CN
--></g></svg></p><p>&#x2003;&#x2003;<strong>&#x63A5;&#x4E0B;&#x56FE;</strong></p>
<p><!--?xml version="1.0" encoding="UTF-8" standalone="no"?--><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" contentscripttype="application/ecmascript" contentstyletype="text/css" height="668px" preserveAspectRatio="none" style="width:748px;height:668px;" version="1.1" viewBox="0 0 748 668" width="748px" zoomAndPan="magnify"><defs><filter height="300%" id="f6cb9db809zy3" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><text fill="#000000" font-family="sans-serif" font-size="18" lengthAdjust="spacingAndGlyphs" textLength="165" x="290.5" y="30.6279">&#x7B2C;&#x4E09;&#x6B65;&#xFF1A;elan &#x66F4;&#x65B0;&#x7EED;</text><ellipse cx="361.5" cy="44.583" fill="#000000" filter="url(#f6cb9db809zy3)" rx="10" ry="10" style="stroke: none; stroke-width: 1.0;"/><rect fill="#99FF99" filter="url(#f6cb9db809zy3)" height="36.3887" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="180" x="271.5" y="74.583"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="160" x="281.5" y="98.335">elan-instances/elan-instance</text><rect fill="#FEFECE" filter="url(#f6cb9db809zy3)" height="36.3887" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="58" x="332.5" y="130.9717"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="38" x="342.5" y="154.7236">update</text><rect fill="#000000" filter="url(#f6cb9db809zy3)" height="6" rx="2.5" ry="2.5" style="stroke: #000000; stroke-width: 1.0;" width="727" x="10" y="187.3604"/><rect fill="#FEFECE" filter="url(#f6cb9db809zy3)" height="36.3887" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="29" x="22" y="358.4548"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="9" x="32" y="382.2068">...</text><ellipse cx="36.5" cy="440.8435" fill="#FFFFFF" filter="url(#f6cb9db809zy3)" rx="11" ry="11" style="stroke: #000000; stroke-width: 1.0;"/><ellipse cx="36.5" cy="440.8435" fill="#000000" rx="6" ry="6" style="stroke: #7F7F7F; stroke-width: 1.0;"/><rect fill="#FEFECE" filter="url(#f6cb9db809zy3)" height="36.3887" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="140" x="290.5" y="213.3604"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="120" x="300.5" y="237.1123">ElanInstanceManager</text><polygon fill="#FEFECE" filter="url(#f6cb9db809zy3)" points="225,319.2605,496,319.2605,508,331.2605,496,343.2605,225,343.2605,213,331.2605,225,319.2605" style="stroke: #A80036; stroke-width: 1.5;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="271" x="225" y="336.355">update.getElanTag() == null  || update.getElanTag() == 0L</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="18" x="195" y="328.8435">yes</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="12" x="508" y="328.8435">no</text><rect fill="#FEFECE" filter="url(#f6cb9db809zy3)" height="36.3887" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="266" x="61" y="353.2605"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="246" x="71" y="377.0125">update the elan-Instance with new properties</text><rect fill="#FEFECE" filter="url(#f6cb9db809zy3)" height="36.3887" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="230" x="79" y="424.6492"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="210" x="89" y="448.4011">ElanUtils.updateOperationalDataStore</text><rect fill="#FEFECE" filter="url(#f6cb9db809zy3)" height="36.3887" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="92" x="148" y="481.0378"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="72" x="158" y="504.7898">&#x89C1;&#x7B2C;&#x4E8C;&#x6B65;&#x6D41;&#x7A0B;</text><rect fill="#FEFECE" filter="url(#f6cb9db809zy3)" height="52.7773" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="360" x="347" y="353.2605"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="340" x="357" y="377.0125">handleunprocessedElanInterfaces(&#x5904;&#x7406;&#x6DFB;&#x52A0;elan interface&#x65F6;&#xFF0C;</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="261" x="357" y="393.4011">elan tag is not updated&#x7684;&#x7AEF;&#x53E3;&#xFF0C;&#x7F13;&#x5B58;&#x53EF;&#x80FD;&#x6709;&#x95EE;&#x9898;)</text><polygon fill="#FEFECE" filter="url(#f6cb9db809zy3)" points="360.5,523.4265,372.5,535.4265,360.5,547.4265,348.5,535.4265,360.5,523.4265" style="stroke: #A80036; stroke-width: 1.5;"/><polygon fill="#FEFECE" filter="url(#f6cb9db809zy3)" points="192.5,269.749,528.5,269.749,540.5,281.749,528.5,293.749,192.5,293.749,180.5,281.749,192.5,269.749" style="stroke: #A80036; stroke-width: 1.5;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="18" x="364.5" y="306.355">yes</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="336" x="192.5" y="286.8435">existingElanTag == null || !existingElanTag.equals(update.getElanTag())</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="12" x="540.5" y="279.332">no</text><polygon fill="#FEFECE" filter="url(#f6cb9db809zy3)" points="360.5,567.4265,372.5,579.4265,360.5,591.4265,348.5,579.4265,360.5,567.4265" style="stroke: #A80036; stroke-width: 1.5;"/><rect fill="#000000" filter="url(#f6cb9db809zy3)" height="6" rx="2.5" ry="2.5" style="stroke: #000000; stroke-width: 1.0;" width="727" x="10" y="611.4265"/><ellipse cx="361.5" cy="647.4265" fill="#FFFFFF" filter="url(#f6cb9db809zy3)" rx="10" ry="10" style="stroke: #000000; stroke-width: 1.5;"/><line style="stroke: #000000; stroke-width: 2.5;" x1="355.3128" x2="367.6872" y1="641.2393" y2="653.6137"/><line style="stroke: #000000; stroke-width: 2.5;" x1="367.6872" x2="355.3128" y1="641.2393" y2="653.6137"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="361.5" x2="361.5" y1="54.583" y2="74.583"/><polygon fill="#A80036" points="357.5,64.583,361.5,74.583,365.5,64.583,361.5,68.583" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="361.5" x2="361.5" y1="110.9717" y2="130.9717"/><polygon fill="#A80036" points="357.5,120.9717,361.5,130.9717,365.5,120.9717,361.5,124.9717" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="36.5" x2="36.5" y1="394.8435" y2="429.8435"/><polygon fill="#A80036" points="32.5,419.8435,36.5,429.8435,40.5,419.8435,36.5,423.8435" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="194" x2="194" y1="389.6492" y2="424.6492"/><polygon fill="#A80036" points="190,414.6492,194,424.6492,198,414.6492,194,418.6492" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="194" x2="194" y1="461.0378" y2="481.0378"/><polygon fill="#A80036" points="190,471.0378,194,481.0378,198,471.0378,194,475.0378" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="213" x2="194" y1="331.2605" y2="331.2605"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="194" x2="194" y1="331.2605" y2="353.2605"/><polygon fill="#A80036" points="190,343.2605,194,353.2605,198,343.2605,194,347.2605" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="508" x2="527" y1="331.2605" y2="331.2605"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="527" x2="527" y1="331.2605" y2="353.2605"/><polygon fill="#A80036" points="523,343.2605,527,353.2605,531,343.2605,527,347.2605" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="194" x2="194" y1="517.4265" y2="535.4265"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="194" x2="348.5" y1="535.4265" y2="535.4265"/><polygon fill="#A80036" points="338.5,531.4265,348.5,535.4265,338.5,539.4265,342.5,535.4265" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="527" x2="527" y1="406.0378" y2="535.4265"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="527" x2="372.5" y1="535.4265" y2="535.4265"/><polygon fill="#A80036" points="382.5,531.4265,372.5,535.4265,382.5,539.4265,378.5,535.4265" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="360.5" x2="360.5" y1="293.749" y2="319.2605"/><polygon fill="#A80036" points="356.5,309.2605,360.5,319.2605,364.5,309.2605,360.5,313.2605" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="540.5" x2="721" y1="281.749" y2="281.749"/><polygon fill="#A80036" points="717,430.8435,721,440.8435,725,430.8435,721,434.8435" style="stroke: #A80036; stroke-width: 1.5;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="721" x2="721" y1="281.749" y2="579.4265"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="721" x2="372.5" y1="579.4265" y2="579.4265"/><polygon fill="#A80036" points="382.5,575.4265,372.5,579.4265,382.5,583.4265,378.5,579.4265" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="360.5" x2="360.5" y1="547.4265" y2="567.4265"/><polygon fill="#A80036" points="356.5,557.4265,360.5,567.4265,364.5,557.4265,360.5,561.4265" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="360.5" x2="360.5" y1="249.749" y2="269.749"/><polygon fill="#A80036" points="356.5,259.749,360.5,269.749,364.5,259.749,360.5,263.749" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="36.5" x2="36.5" y1="193.3604" y2="358.4548"/><polygon fill="#A80036" points="32.5,348.4548,36.5,358.4548,40.5,348.4548,36.5,352.4548" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="360.5" x2="360.5" y1="193.3604" y2="213.3604"/><polygon fill="#A80036" points="356.5,203.3604,360.5,213.3604,364.5,203.3604,360.5,207.3604" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="360.5" x2="360.5" y1="591.4265" y2="611.4265"/><polygon fill="#A80036" points="356.5,601.4265,360.5,611.4265,364.5,601.4265,360.5,605.4265" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="361.5" x2="361.5" y1="167.3604" y2="187.3604"/><polygon fill="#A80036" points="357.5,177.3604,361.5,187.3604,365.5,177.3604,361.5,181.3604" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="361.5" x2="361.5" y1="617.4265" y2="637.4265"/><polygon fill="#A80036" points="357.5,627.4265,361.5,637.4265,365.5,627.4265,361.5,631.4265" style="stroke: #A80036; stroke-width: 1.0;"/><!--
@startuml
title 第三步：elan 更新续
start
    #99FF99:elan-instances/elan-instance;
    :update; 
    fork
        :...;
        stop  
    fork again
        :ElanInstanceManager;
        if (existingElanTag == null || !existingElanTag.equals(update.getElanTag()))then(yes)
            if (update.getElanTag() == null  || update.getElanTag() == 0L)then(yes)
                :update the elan-Instance with new properties;
                :ElanUtils.updateOperationalDataStore;
                :见第二步流程;
            else(no)
                :handleunprocessedElanInterfaces(处理添加elan interface时，\nelan tag is not updated的端口，缓存可能有问题);
            endif
        else(no)
        endif
    end fork
   
end

@enduml

PlantUML version 1.2019.07(Tue Jun 25 03:59:20 CST 2019)
(MIT source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) 64-Bit Server VM
Java Version: 1.8.0_191-b12
Operating System: Windows 10
OS Version: 10.0
Default Encoding: GBK
Language: zh
Country: CN
--></g></svg></p><h3 class="mume-header" id="12-update" ebook-toc-level-3 heading="1.2. update">1.2. update</h3>

<p>&#x2003;&#x2003;&#x5F53;&#x5317;&#x5411;api &#x66F4;&#x65B0;neutron/network/network&#x540E;&#xFF0C;NeutronNetworkChangeListener&#x4E0D;&#x4F5C;&#x5176;&#x4ED6;&#x64CD;&#x4F5C;.</p>
<p><!--?xml version="1.0" encoding="UTF-8" standalone="no"?--><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" contentscripttype="application/ecmascript" contentstyletype="text/css" height="469px" preserveAspectRatio="none" style="width:682px;height:469px;" version="1.1" viewBox="0 0 682 469" width="682px" zoomAndPan="magnify"><defs><filter height="300%" id="f9sg4wyac9cl6" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><text fill="#000000" font-family="sans-serif" font-size="18" lengthAdjust="spacingAndGlyphs" textLength="72" x="304" y="30.6279">&#x7F51;&#x7EDC;&#x66F4;&#x65B0;</text><ellipse cx="340.5" cy="44.583" fill="#000000" filter="url(#f9sg4wyac9cl6)" rx="10" ry="10" style="stroke: none; stroke-width: 1.0;"/><rect fill="#99FF99" filter="url(#f9sg4wyac9cl6)" height="36.3887" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="154" x="263.5" y="74.583"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="134" x="273.5" y="98.335">neutron/network/network</text><rect fill="#FEFECE" filter="url(#f9sg4wyac9cl6)" height="36.3887" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="58" x="311.5" y="130.9717"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="38" x="321.5" y="154.7236">update</text><rect fill="#000000" filter="url(#f9sg4wyac9cl6)" height="6" rx="2.5" ry="2.5" style="stroke: #000000; stroke-width: 1.0;" width="661" x="10" y="187.3604"/><rect fill="#FEFECE" filter="url(#f9sg4wyac9cl6)" height="36.3887" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="124" x="59" y="213.3604"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="104" x="69" y="237.1123">bundle:neutronVpn</text><rect fill="#FEFECE" filter="url(#f9sg4wyac9cl6)" height="36.3887" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="198" x="22" y="284.749"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="178" x="32" y="308.501">NeutronNetworkChangeListener</text><rect fill="#FEFECE" filter="url(#f9sg4wyac9cl6)" height="36.3887" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="78" x="82" y="356.1377"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="58" x="92" y="379.8896">do nothing</text><rect fill="#FEFECE" filter="url(#f9sg4wyac9cl6)" height="36.3887" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="123" x="267.5" y="249.0547"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="103" x="277.5" y="272.8066">bundle:ipv6Service</text><rect fill="#FEFECE" filter="url(#f9sg4wyac9cl6)" height="36.3887" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="198" x="230" y="320.4434"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="178" x="240" y="344.1953">NeutronNetworkChangeListener</text><rect fill="#FEFECE" filter="url(#f9sg4wyac9cl6)" height="36.3887" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="121" x="488" y="249.0547"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="101" x="498" y="272.8066">bundle:qosservice</text><rect fill="#FEFECE" filter="url(#f9sg4wyac9cl6)" height="36.3887" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="221" x="438" y="320.4434"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="201" x="448" y="344.1953">QosNeutronNetworkChangeListener</text><rect fill="#000000" filter="url(#f9sg4wyac9cl6)" height="6" rx="2.5" ry="2.5" style="stroke: #000000; stroke-width: 1.0;" width="661" x="10" y="412.5264"/><ellipse cx="340.5" cy="448.5264" fill="#FFFFFF" filter="url(#f9sg4wyac9cl6)" rx="10" ry="10" style="stroke: #000000; stroke-width: 1.5;"/><line style="stroke: #000000; stroke-width: 2.5;" x1="334.3128" x2="346.6872" y1="442.3392" y2="454.7136"/><line style="stroke: #000000; stroke-width: 2.5;" x1="346.6872" x2="334.3128" y1="442.3392" y2="454.7136"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="340.5" x2="340.5" y1="54.583" y2="74.583"/><polygon fill="#A80036" points="336.5,64.583,340.5,74.583,344.5,64.583,340.5,68.583" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="340.5" x2="340.5" y1="110.9717" y2="130.9717"/><polygon fill="#A80036" points="336.5,120.9717,340.5,130.9717,344.5,120.9717,340.5,124.9717" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="121" x2="121" y1="249.749" y2="284.749"/><polygon fill="#A80036" points="117,274.749,121,284.749,125,274.749,121,278.749" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="121" x2="121" y1="321.1377" y2="356.1377"/><polygon fill="#A80036" points="117,346.1377,121,356.1377,125,346.1377,121,350.1377" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="329" x2="329" y1="285.4434" y2="320.4434"/><polygon fill="#A80036" points="325,310.4434,329,320.4434,333,310.4434,329,314.4434" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="548.5" x2="548.5" y1="285.4434" y2="320.4434"/><polygon fill="#A80036" points="544.5,310.4434,548.5,320.4434,552.5,310.4434,548.5,314.4434" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="121" x2="121" y1="193.3604" y2="213.3604"/><polygon fill="#A80036" points="117,203.3604,121,213.3604,125,203.3604,121,207.3604" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="329" x2="329" y1="193.3604" y2="249.0547"/><polygon fill="#A80036" points="325,239.0547,329,249.0547,333,239.0547,329,243.0547" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="548.5" x2="548.5" y1="193.3604" y2="249.0547"/><polygon fill="#A80036" points="544.5,239.0547,548.5,249.0547,552.5,239.0547,548.5,243.0547" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="121" x2="121" y1="392.5264" y2="412.5264"/><polygon fill="#A80036" points="117,402.5264,121,412.5264,125,402.5264,121,406.5264" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="329" x2="329" y1="356.832" y2="412.5264"/><polygon fill="#A80036" points="325,402.5264,329,412.5264,333,402.5264,329,406.5264" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="548.5" x2="548.5" y1="356.832" y2="412.5264"/><polygon fill="#A80036" points="544.5,402.5264,548.5,412.5264,552.5,402.5264,548.5,406.5264" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="340.5" x2="340.5" y1="167.3604" y2="187.3604"/><polygon fill="#A80036" points="336.5,177.3604,340.5,187.3604,344.5,177.3604,340.5,181.3604" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="340.5" x2="340.5" y1="418.5264" y2="438.5264"/><polygon fill="#A80036" points="336.5,428.5264,340.5,438.5264,344.5,428.5264,340.5,432.5264" style="stroke: #A80036; stroke-width: 1.0;"/><!--
@startuml
title 网络更新
start
    #99FF99:neutron/network/network;
    :update; 
    fork
        :bundle:neutronVpn; 
        :NeutronNetworkChangeListener;
        :do nothing;
    fork again
        :bundle:ipv6Service;
        :NeutronNetworkChangeListener;
    fork again
        :bundle:qosservice;
        :QosNeutronNetworkChangeListener;
    end fork
    
end

@enduml

PlantUML version 1.2019.07(Tue Jun 25 03:59:20 CST 2019)
(MIT source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) 64-Bit Server VM
Java Version: 1.8.0_191-b12
Operating System: Windows 10
OS Version: 10.0
Default Encoding: GBK
Language: zh
Country: CN
--></g></svg></p><h3 class="mume-header" id="13-remove" ebook-toc-level-3 heading="1.3. remove">1.3. remove</h3>

<hr>
<p style="text-align: center;"><strong>&#x7B2C;&#x4E00;&#x6B65;&#xFF1A;&#x5220;&#x9664;&#x7F51;&#x7EDC;</strong></p>
<p><!--?xml version="1.0" encoding="UTF-8" standalone="no"?--><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" contentscripttype="application/ecmascript" contentstyletype="text/css" height="673px" preserveAspectRatio="none" style="width:687px;height:673px;" version="1.1" viewBox="0 0 687 673" width="687px" zoomAndPan="magnify"><defs><filter height="300%" id="f1in6kka1lyut8" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><text fill="#000000" font-family="sans-serif" font-size="18" lengthAdjust="spacingAndGlyphs" textLength="72" x="306.75" y="30.6279">&#x7F51;&#x7EDC;&#x5220;&#x9664;</text><ellipse cx="345.25" cy="44.583" fill="#000000" filter="url(#f1in6kka1lyut8)" rx="10" ry="10" style="stroke: none; stroke-width: 1.0;"/><rect fill="#99FF99" filter="url(#f1in6kka1lyut8)" height="36.3887" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="154" x="268.25" y="74.583"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="134" x="278.25" y="98.335">neutron/network/network</text><rect fill="#FEFECE" filter="url(#f1in6kka1lyut8)" height="36.3887" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="61" x="314.75" y="130.9717"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="41" x="324.75" y="154.7236">remove</text><rect fill="#000000" filter="url(#f1in6kka1lyut8)" height="6" rx="2.5" ry="2.5" style="stroke: #000000; stroke-width: 1.0;" width="666.5" x="10" y="187.3604"/><rect fill="#FEFECE" filter="url(#f1in6kka1lyut8)" height="36.3887" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="124" x="59" y="213.3604"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="104" x="69" y="237.1123">bundle:neutronVpn</text><rect fill="#FEFECE" filter="url(#f1in6kka1lyut8)" height="36.3887" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="198" x="22" y="269.749"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="178" x="32" y="293.501">NeutronNetworkChangeListener</text><rect fill="#FEFECE" filter="url(#f1in6kka1lyut8)" height="36.3887" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="92" x="75" y="326.1377"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="72" x="85" y="349.8896">&#x5916;&#x90E8;&#x7F51;&#x7EDC;&#x5904;&#x7406;</text><rect fill="#99FF99" filter="url(#f1in6kka1lyut8)" height="36.3887" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="180" x="31" y="396.3435"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="160" x="41" y="420.0955">elan-instances/elan-instance</text><rect fill="#99FF99" filter="url(#f1in6kka1lyut8)" height="36.3887" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="148" x="47" y="516.0608"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="128" x="57" y="539.8127">delete ds elan instance</text><polygon fill="#FEFECE" filter="url(#f1in6kka1lyut8)" points="44.5,466.5493,197.5,466.5493,209.5,478.5493,197.5,490.5493,44.5,490.5493,32.5,478.5493,44.5,466.5493" style="stroke: #A80036; stroke-width: 1.5;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="18" x="125" y="503.1553">yes</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="153" x="44.5" y="483.6438">readDs ElanInstance isPresent?</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="12" x="209.5" y="476.1323">no</text><polygon fill="#FEFECE" filter="url(#f1in6kka1lyut8)" points="121,572.4495,133,584.4495,121,596.4495,109,584.4495,121,572.4495" style="stroke: #A80036; stroke-width: 1.5;"/><rect fill="#FEFECE" filter="url(#f1in6kka1lyut8)" height="36.3887" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="123" x="273" y="339.9548"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="103" x="283" y="363.7068">bundle:ipv6Service</text><rect fill="#FEFECE" filter="url(#f1in6kka1lyut8)" height="36.3887" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="198" x="235.5" y="410.1606"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="178" x="245.5" y="433.9126">NeutronNetworkChangeListener</text><rect fill="#FEFECE" filter="url(#f1in6kka1lyut8)" height="36.3887" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="121" x="493.5" y="339.9548"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="101" x="503.5" y="363.7068">bundle:qosservice</text><rect fill="#FEFECE" filter="url(#f1in6kka1lyut8)" height="36.3887" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="221" x="443.5" y="410.1606"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="201" x="453.5" y="433.9126">QosNeutronNetworkChangeListener</text><rect fill="#000000" filter="url(#f1in6kka1lyut8)" height="6" rx="2.5" ry="2.5" style="stroke: #000000; stroke-width: 1.0;" width="666.5" x="10" y="616.4495"/><ellipse cx="345.25" cy="652.4495" fill="#FFFFFF" filter="url(#f1in6kka1lyut8)" rx="10" ry="10" style="stroke: #000000; stroke-width: 1.5;"/><line style="stroke: #000000; stroke-width: 2.5;" x1="339.0628" x2="351.4372" y1="646.2623" y2="658.6366"/><line style="stroke: #000000; stroke-width: 2.5;" x1="351.4372" x2="339.0628" y1="646.2623" y2="658.6366"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="345.25" x2="345.25" y1="54.583" y2="74.583"/><polygon fill="#A80036" points="341.25,64.583,345.25,74.583,349.25,64.583,345.25,68.583" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="345.25" x2="345.25" y1="110.9717" y2="130.9717"/><polygon fill="#A80036" points="341.25,120.9717,345.25,130.9717,349.25,120.9717,345.25,124.9717" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="121" x2="121" y1="249.749" y2="269.749"/><polygon fill="#A80036" points="117,259.749,121,269.749,125,259.749,121,263.749" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="121" x2="121" y1="306.1377" y2="326.1377"/><polygon fill="#A80036" points="117,316.1377,121,326.1377,125,316.1377,121,320.1377" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="121" x2="121" y1="362.5264" y2="396.3435"/><polygon fill="#A80036" points="117,386.3435,121,396.3435,125,386.3435,121,390.3435" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="121" x2="121" y1="490.5493" y2="516.0608"/><polygon fill="#A80036" points="117,506.0608,121,516.0608,125,506.0608,121,510.0608" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="209.5" x2="221.5" y1="478.5493" y2="478.5493"/><polygon fill="#A80036" points="217.5,524.2551,221.5,534.2551,225.5,524.2551,221.5,528.2551" style="stroke: #A80036; stroke-width: 1.5;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="221.5" x2="221.5" y1="478.5493" y2="584.4495"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="221.5" x2="133" y1="584.4495" y2="584.4495"/><polygon fill="#A80036" points="143,580.4495,133,584.4495,143,588.4495,139,584.4495" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="121" x2="121" y1="552.4495" y2="572.4495"/><polygon fill="#A80036" points="117,562.4495,121,572.4495,125,562.4495,121,566.4495" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="121" x2="121" y1="432.7322" y2="466.5493"/><polygon fill="#A80036" points="117,456.5493,121,466.5493,125,456.5493,121,460.5493" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="334.5" x2="334.5" y1="376.3435" y2="410.1606"/><polygon fill="#A80036" points="330.5,400.1606,334.5,410.1606,338.5,400.1606,334.5,404.1606" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="554" x2="554" y1="376.3435" y2="410.1606"/><polygon fill="#A80036" points="550,400.1606,554,410.1606,558,400.1606,554,404.1606" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="121" x2="121" y1="193.3604" y2="213.3604"/><polygon fill="#A80036" points="117,203.3604,121,213.3604,125,203.3604,121,207.3604" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="334.5" x2="334.5" y1="193.3604" y2="339.9548"/><polygon fill="#A80036" points="330.5,329.9548,334.5,339.9548,338.5,329.9548,334.5,333.9548" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="554" x2="554" y1="193.3604" y2="339.9548"/><polygon fill="#A80036" points="550,329.9548,554,339.9548,558,329.9548,554,333.9548" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="121" x2="121" y1="596.4495" y2="616.4495"/><polygon fill="#A80036" points="117,606.4495,121,616.4495,125,606.4495,121,610.4495" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="334.5" x2="334.5" y1="446.5493" y2="616.4495"/><polygon fill="#A80036" points="330.5,606.4495,334.5,616.4495,338.5,606.4495,334.5,610.4495" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="554" x2="554" y1="446.5493" y2="616.4495"/><polygon fill="#A80036" points="550,606.4495,554,616.4495,558,606.4495,554,610.4495" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="345.25" x2="345.25" y1="167.3604" y2="187.3604"/><polygon fill="#A80036" points="341.25,177.3604,345.25,187.3604,349.25,177.3604,345.25,181.3604" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="345.25" x2="345.25" y1="622.4495" y2="642.4495"/><polygon fill="#A80036" points="341.25,632.4495,345.25,642.4495,349.25,632.4495,345.25,636.4495" style="stroke: #A80036; stroke-width: 1.0;"/><!--
@startuml
title 网络删除
start
    #99FF99:neutron/network/network;
    :remove; 
    fork
        :bundle:neutronVpn; 
        :NeutronNetworkChangeListener;
        :外部网络处理;
        #99FF99:elan-instances/elan-instance;
        if (readDs ElanInstance isPresent?) then (yes)
             #99FF99:delete ds elan instance; 
        else (no)
        endif
    fork again
        :bundle:ipv6Service;
        :NeutronNetworkChangeListener;
    fork again
        :bundle:qosservice;
        :QosNeutronNetworkChangeListener;
    end fork
    
end

@enduml

PlantUML version 1.2019.07(Tue Jun 25 03:59:20 CST 2019)
(MIT source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) 64-Bit Server VM
Java Version: 1.8.0_191-b12
Operating System: Windows 10
OS Version: 10.0
Default Encoding: GBK
Language: zh
Country: CN
--></g></svg></p><p>&#x2003;&#x2003;&#x5220;&#x9664;&#x6570;&#x636E;&#x5E93;&#x4E2D;&#x7684;elan instance&#x6570;&#x636E;&#x540E;&#xFF0C;&#x89E6;&#x53D1;&#x76F8;&#x5173;&#x7684;&#x5176;&#x4ED6;&#x6D41;&#x7A0B;&#x3002;</p>
<hr>
<p style="text-align: center;"><strong>&#x7B2C;&#x4E8C;&#x6B65;&#xFF1A;elan&#x5220;&#x9664;</strong></p>
<h2 class="mume-header" id="2-vlan%E7%BD%91%E7%BB%9C%E5%88%9B%E5%BB%BA" ebook-toc-level-2 heading="2. vlan&amp;#x7F51;&amp;#x7EDC;&amp;#x521B;&amp;#x5EFA;">2. vlan&#x7F51;&#x7EDC;&#x521B;&#x5EFA;</h2>

<p>&#x2003;&#x2003;vlan &#x7F51;&#x7EDC;&#x521B;&#x5EFA;&#x65F6;&#xFF0C;&#x4F1A;&#x63D0;&#x524D;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;elan interface &#x5230;&#x4E1A;&#x52A1;&#x53E3;&#x7684;&#x6620;&#x5C04;&#x3002;&#xFF08;odl&#x539F;&#x751F;&#x4EE3;&#x7801;&#x4E2D;&#x6CA1;&#x6709;&#xFF09;&#x5728;&#x8F6F;&#x4EF6;vtep &#x73AF;&#x5883;&#x4E0B;&#x521B;&#x5EFA;vlan &#x7F51;&#x7EDC;&#x6216;&#x8005;&#x786C;&#x4EF6;vtep&#x73AF;&#x5883;&#x4E0B;&#x521B;&#x5EFA;&#x7F51;&#x7EDC;&#xFF08;overlay&#x4F1A;&#x5C06;openstack&#x521B;&#x5EFA;&#x7684;vxlan&#x7F51;&#x7EDC;&#x4FEE;&#x6539;&#x4E3A;vlan&#x7F51;&#x7EDC;&#xFF09;&#x4F1A;&#x88AB;&#x89E6;&#x53D1;&#x3002;</p>
<p style="text-align: center;"><strong>&#x7B2C;&#x4E00;&#x6B65;&#xFF1A;vlan &#x7F51;&#x7EDC;&#x521B;&#x5EFA;</strong></p>
<p><!--?xml version="1.0" encoding="UTF-8" standalone="no"?--><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" contentscripttype="application/ecmascript" contentstyletype="text/css" height="809px" preserveAspectRatio="none" style="width:974px;height:809px;" version="1.1" viewBox="0 0 974 809" width="974px" zoomAndPan="magnify"><defs><filter height="300%" id="f12os4i77m8sfn" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="90" x="443" y="26.0439">vlan&#x7F51;&#x7EDC;&#x521B;&#x5EFA;</text><rect fill="#FFFFFF" filter="url(#f12os4i77m8sfn)" height="573.208" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="330" y="175.5034"/><rect fill="#FFFFFF" filter="url(#f12os4i77m8sfn)" height="51.5317" style="stroke: #000000; stroke-width: 2.0;" width="274" x="159" y="195.5034"/><rect fill="#FFFFFF" filter="url(#f12os4i77m8sfn)" height="412.1675" style="stroke: #000000; stroke-width: 2.0;" width="746" x="217" y="261.0352"/><rect fill="#FFFFFF" filter="url(#f12os4i77m8sfn)" height="336.6357" style="stroke: #000000; stroke-width: 2.0;" width="726" x="227" y="329.5669"/><rect fill="#FFFFFF" filter="url(#f12os4i77m8sfn)" height="115.0405" style="stroke: #000000; stroke-width: 2.0;" width="659" x="237" y="419.853"/><rect fill="#FFFFFF" filter="url(#f12os4i77m8sfn)" height="110.3091" style="stroke: #000000; stroke-width: 2.0;" width="706" x="237" y="548.8936"/><rect fill="#FFFFFF" height="48.7773" style="stroke: none; stroke-width: 1.0;" width="706" x="237" y="610.4253"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="203" x2="203" y1="74.2402" y2="766.7114"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="335" x2="335" y1="74.2402" y2="766.7114"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="568" x2="568" y1="74.2402" y2="766.7114"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="820" x2="820" y1="74.2402" y2="766.7114"/><rect fill="#99FF99" filter="url(#f12os4i77m8sfn)" height="33.1201" style="stroke: #A80036; stroke-width: 1.5;" width="64" x="169" y="36.1201"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="50" x="176" y="59.1641">elan_ds</text><rect fill="#99FF99" filter="url(#f12os4i77m8sfn)" height="33.1201" style="stroke: #A80036; stroke-width: 1.5;" width="64" x="169" y="765.7114"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="50" x="176" y="788.7554">elan_ds</text><rect fill="#FEFECE" filter="url(#f12os4i77m8sfn)" height="33.1201" style="stroke: #A80036; stroke-width: 1.5;" width="172" x="247" y="36.1201"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="158" x="254" y="59.1641">ElanInstanceDpnListener</text><rect fill="#FEFECE" filter="url(#f12os4i77m8sfn)" height="33.1201" style="stroke: #A80036; stroke-width: 1.5;" width="172" x="247" y="765.7114"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="158" x="254" y="788.7554">ElanInstanceDpnListener</text><rect fill="#FEFECE" filter="url(#f12os4i77m8sfn)" height="33.1201" style="stroke: #A80036; stroke-width: 1.5;" width="142" x="495" y="36.1201"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="128" x="502" y="59.1641">ElanServiceProvider</text><rect fill="#FEFECE" filter="url(#f12os4i77m8sfn)" height="33.1201" style="stroke: #A80036; stroke-width: 1.5;" width="142" x="495" y="765.7114"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="128" x="502" y="788.7554">ElanServiceProvider</text><rect fill="#FEFECE" filter="url(#f12os4i77m8sfn)" height="33.1201" style="stroke: #A80036; stroke-width: 1.5;" width="128" x="754" y="36.1201"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="114" x="761" y="59.1641">IInterfaceManager</text><rect fill="#FEFECE" filter="url(#f12os4i77m8sfn)" height="33.1201" style="stroke: #A80036; stroke-width: 1.5;" width="128" x="754" y="765.7114"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="114" x="761" y="788.7554">IInterfaceManager</text><rect fill="#FFFFFF" filter="url(#f12os4i77m8sfn)" height="573.208" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="330" y="175.5034"/><polygon fill="#A80036" points="323,117.8718,333,121.8718,323,125.8718,327,121.8718" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="203" x2="329" y1="121.8718" y2="121.8718"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="26" x="210" y="117.0154">&#x901A;&#x77E5;</text><path d="M8,89.2402 L8,134.2402 L194,134.2402 L194,99.2402 L184,89.2402 L8,89.2402 " fill="#FBFB77" filter="url(#f12os4i77m8sfn)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M184,89.2402 L184,99.2402 L194,99.2402 L184,89.2402 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="54" x="14" y="109.1382">datastore</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="165" x="14" y="126.8926">elan-instances/elan-instance</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="335" x2="382" y1="162.5034" y2="162.5034"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="382" x2="382" y1="162.5034" y2="175.5034"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="341" x2="382" y1="175.5034" y2="175.5034"/><polygon fill="#A80036" points="351,171.5034,341,175.5034,351,179.5034,347,175.5034" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="21" x="347" y="157.647">add</text><path d="M159,195.5034 L220,195.5034 L220,204.5034 L210,214.5034 L159,214.5034 L159,195.5034 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="51.5317" style="stroke: #000000; stroke-width: 2.0;" width="274" x="159" y="195.5034"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="16" x="174" y="211.4014">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="110" x="235" y="210.1094">[(&#x5916;&#x90E8;&#x7F51;&#x7EDC; || &#xFF01;vlan)]</text><path d="M438,200.5034 L438,227.5034 L676,227.5034 L676,210.5034 L666,200.5034 L438,200.5034 " fill="#FBFB77" filter="url(#f12os4i77m8sfn)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M666,200.5034 L666,210.5034 L676,210.5034 L666,200.5034 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="217" x="444" y="220.4014">&#x53EA;&#x6709;&#x5185;&#x90E8;vlan&#x7F51;&#x7EDC;&#x624D;&#x89E6;&#x53D1;&#x63A5;&#x4E0B;&#x6765;&#x7684;&#x6D41;&#x7A0B;</text><polygon fill="#A80036" points="214,235.0352,204,239.0352,214,243.0352,210,239.0352" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="208" x2="329" y1="239.0352" y2="239.0352"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="33" x="220" y="234.1787">return</text><path d="M217,261.0352 L290,261.0352 L290,270.0352 L280,280.0352 L217,280.0352 L217,261.0352 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="412.1675" style="stroke: #000000; stroke-width: 2.0;" width="746" x="217" y="261.0352"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="28" x="232" y="276.9331">loop</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="77" x="305" y="275.6411">[node in topo]</text><polygon fill="#A80036" points="556,305.5669,566,309.5669,556,313.5669,560,309.5669" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="340" x2="562" y1="309.5669" y2="309.5669"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="157" x="347" y="304.7104">createExternalElanNetwork</text><path d="M573,285.8125 L573,312.8125 L778,312.8125 L778,295.8125 L768,285.8125 L573,285.8125 " fill="#FBFB77" filter="url(#f12os4i77m8sfn)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M768,285.8125 L768,295.8125 L778,295.8125 L768,285.8125 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="184" x="579" y="305.7104">&#x501F;&#x7528;&#x5916;&#x90E8;&#x7F51;&#x7EDC;&#x903B;&#x8F91;&#x521B;&#x5EFA;elan &#x63A5;&#x53E3;</text><path d="M227,329.5669 L288,329.5669 L288,338.5669 L278,348.5669 L227,348.5669 L227,329.5669 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="336.6357" style="stroke: #000000; stroke-width: 2.0;" width="726" x="227" y="329.5669"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="16" x="242" y="345.4648">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="175" x="303" y="344.1729">[(&#x6570;&#x636E;&#x5E93;&#x4E0D;&#x5B58;&#x5728;&#x6B64;elan interface)]</text><polygon fill="#A80036" points="556,369.0986,566,373.0986,556,377.0986,560,373.0986" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="340" x2="562" y1="373.0986" y2="373.0986"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="157" x="347" y="368.2422">createExternalElanNetwork</text><polygon fill="#A80036" points="556,400.853,566,404.853,556,408.853,560,404.853" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="340" x2="562" y1="404.853" y2="404.853"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="109" x="347" y="399.9966">createIetfInterfaces</text><path d="M237,419.853 L298,419.853 L298,428.853 L288,438.853 L237,438.853 L237,419.853 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="115.0405" style="stroke: #000000; stroke-width: 2.0;" width="659" x="237" y="419.853"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="16" x="252" y="435.751">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="157" x="313" y="434.459">[(&#x6570;&#x636E;&#x5E93;&#x4E0D;&#x5B58;&#x5728;&#x7F51;&#x7EDC;trunk &#x53E3;)]</text><polygon fill="#A80036" points="556,459.3848,566,463.3848,556,467.3848,560,463.3848" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="340" x2="562" y1="463.3848" y2="463.3848"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="157" x="347" y="458.5283">createExternalElanNetwork</text><polygon fill="#A80036" points="556,491.1392,566,495.1392,556,499.1392,560,495.1392" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="340" x2="562" y1="495.1392" y2="495.1392"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="109" x="347" y="490.2827">createIetfInterfaces</text><polygon fill="#A80036" points="808,522.8936,818,526.8936,808,530.8936,812,526.8936" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="340" x2="814" y1="526.8936" y2="526.8936"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="200" x="347" y="522.0371">createVLANInterface(&#x521B;&#x5EFA;trunk&#x53E3;)&quot;</text><text fill="#43CD80" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="231" x="547" y="522.0371">&#x6CE8;&#x610F;&#x6B64;&#x5904;&#x5199; ietf-interfaces config&#x5E93;  &quot;</text><path d="M237,548.8936 L298,548.8936 L298,557.8936 L288,567.8936 L237,567.8936 L237,548.8936 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="110.3091" style="stroke: #000000; stroke-width: 2.0;" width="706" x="237" y="548.8936"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="16" x="252" y="564.7915">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="57" x="313" y="563.4995">[(flat&#x7F51;&#x7EDC;)]</text><polygon fill="#A80036" points="351,593.4253,341,597.4253,351,601.4253,347,597.4253" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="345" x2="819" y1="597.4253" y2="597.4253"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="100" x="357" y="592.5688">return trunkName</text><path d="M825,573.6709 L825,600.6709 L924,600.6709 L924,583.6709 L914,573.6709 L825,573.6709 " fill="#FBFB77" filter="url(#f12os4i77m8sfn)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M914,573.6709 L914,583.6709 L924,583.6709 L914,573.6709 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="78" x="831" y="593.5688">&#x6241;&#x5E73;&#x7F51;&#x7EDC;&#x7279;&#x6027;</text><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="237" x2="943" y1="611.4253" y2="611.4253"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="26" x="242" y="624.0313">[not]</text><polygon fill="#A80036" points="808,647.2026,818,651.2026,808,655.2026,812,651.2026" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="340" x2="814" y1="651.2026" y2="651.2026"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="195" x="347" y="646.3462">createVLANInterface(&#x521B;&#x5EFA;elan&#x53E3;)&quot;</text><text fill="#43CD80" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="231" x="542" y="646.3462">&#x6CE8;&#x610F;&#x6B64;&#x5904;&#x5199; ietf-interfaces config&#x5E93;  &quot;</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="568" x2="610" y1="703.957" y2="703.957"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="610" x2="610" y1="703.957" y2="716.957"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="569" x2="610" y1="716.957" y2="716.957"/><polygon fill="#A80036" points="579,712.957,569,716.957,579,720.957,575,716.957" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="238" x="575" y="699.1006">addElanInterface&#xFF08;&#x53EA;&#x6DFB;&#x52A0;elan interface&#xFF09;</text><polygon fill="#A80036" points="214,744.7114,204,748.7114,214,752.7114,210,748.7114" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="208" x2="567" y1="748.7114" y2="748.7114"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="108" x="220" y="743.855">&#x5199;&#x5165;elan interface&quot;</text><text fill="#43CD80" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="233" x="328" y="743.855">&#x6CE8;&#x610F;&#x6B64;&#x5904;&#x5199; elan interface config&#x5E93;  &quot;</text><!--
@startuml
title vlan网络创建
participant elan_ds as elan_ds #99FF99

elan_ds -> ElanInstanceDpnListener:通知
note left
datastore
elan-instances/elan-instance
end note

ElanInstanceDpnListener -> ElanInstanceDpnListener:add
activate ElanInstanceDpnListener
alt (外部网络 || ！vlan)
    ElanInstanceDpnListener -> elan_ds:return
end

note left
只有内部vlan网络才触发接下来的流程
end note

loop node in topo
    ElanInstanceDpnListener -> ElanServiceProvider:createExternalElanNetwork
    note right
        借用外部网络逻辑创建elan 接口
    end note
    alt (数据库不存在此elan interface)
        ElanInstanceDpnListener -> ElanServiceProvider:createExternalElanNetwork
        ElanInstanceDpnListener -> ElanServiceProvider:createIetfInterfaces
        alt (数据库不存在网络trunk 口)
            ElanInstanceDpnListener -> ElanServiceProvider:createExternalElanNetwork
            ElanInstanceDpnListener -> ElanServiceProvider:createIetfInterfaces
            ElanInstanceDpnListener ->IInterfaceManager:createVLANInterface(创建trunk口)"<font color=#43CD80><b>注意此处写 ietf-interfaces config库  "
        end
        alt (flat网络)
        IInterfaceManager -> ElanInstanceDpnListener:return trunkName
        note right
            扁平网络特性
        end note
        else not
            ElanInstanceDpnListener ->IInterfaceManager:createVLANInterface(创建elan口)"<font color=#43CD80><b>注意此处写 ietf-interfaces config库  "
        end
    end
end

ElanServiceProvider -> ElanServiceProvider:addElanInterface（只添加elan interface）
ElanServiceProvider -> elan_ds:写入elan interface"<font color=#43CD80><b>注意此处写 elan interface config库  "
deactivate ElanInstanceDpnListener

@enduml

PlantUML version 1.2019.07(Tue Jun 25 03:59:20 CST 2019)
(MIT source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) 64-Bit Server VM
Java Version: 1.8.0_191-b12
Operating System: Windows 10
OS Version: 10.0
Default Encoding: GBK
Language: zh
Country: CN
--></g></svg></p><p>&#x2003;&#x2003;&#x5728;&#x4E0A;&#x56FE;&#x4E2D;&#xFF0C;&#x6709;&#x51E0;&#x5904;&#x4F1A;&#x5199;&#x6570;&#x636E;&#x5E93;&#x7684;&#x64CD;&#x4F5C;&#xFF0C;&#x56E0;&#x6B64;&#xFF0C;&#x4F1A;&#x89E6;&#x53D1;&#x5176;&#x4ED6;&#x76D1;&#x542C;&#x7A0B;&#x5E8F;&#x3002;</p>
<p>&#x2003;&#x2003;&#x4E0A;&#x56FE;&#x4E2D;trunk &#x53E3;&#x53EF;elan interface&#x7684;&#x89E3;&#x91CA;&#x5982;&#x4E0B;&#x3002;&#x5176;&#x4E2D;<code>IfmConstants.OF_URI_SEPARATOR=&quot;:&quot;</code>&#xFF1B;<code>parentRef = dpnid:&#x4E1A;&#x52A1;&#x53E3;</code></p>
<p style="text-align: center;"></p>
<table>
<thead>
<tr>
<th>&#x7AEF;&#x53E3;&#x6027;&#x8D28;</th>
<th>&#x540D;&#x79F0;&#x89C4;&#x5219;</th>
<th>&#x793A;&#x4F8B;</th>
</tr>
</thead>
<tbody>
<tr>
<td>trunk</td>
<td>parentRef + IfmConstants.OF_URI_SEPARATOR + &quot;trunk&quot;</td>
<td>203100663178074:ens192:trunk</td>
</tr>
<tr>
<td>elan interfaced</td>
<td>parentRef + IfmConstants.OF_URI_SEPARATOR + segmentationId</td>
<td>62457717962162:ens192:100</td>
</tr>
</tbody>
</table>
<hr>
<p style="text-align: center;"><strong>&#x7B2C;&#x4E8C;&#x6B65;&#xFF1A;ietf interface &#x521B;&#x5EFA;</strong></p>
<p><!--?xml version="1.0" encoding="UTF-8" standalone="no"?--><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" contentscripttype="application/ecmascript" contentstyletype="text/css" height="791px" preserveAspectRatio="none" style="width:1429px;height:791px;" version="1.1" viewBox="0 0 1429 791" width="1429px" zoomAndPan="magnify"><defs><filter height="300%" id="fcrgj7ubn2ra6" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><text fill="#000000" font-family="sans-serif" font-size="18" lengthAdjust="spacingAndGlyphs" textLength="134" x="646.75" y="30.6279">ietf interface&#x521B;&#x5EFA;</text><ellipse cx="696.25" cy="44.583" fill="#000000" filter="url(#fcrgj7ubn2ra6)" rx="10" ry="10" style="stroke: none; stroke-width: 1.0;"/><rect fill="#99FF99" filter="url(#fcrgj7ubn2ra6)" height="36.3887" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="174" x="609.25" y="74.583"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="154" x="619.25" y="98.335">interfaces/interface/interface</text><rect fill="#FEFECE" filter="url(#fcrgj7ubn2ra6)" height="36.3887" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="41" x="675.75" y="130.9717"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="21" x="685.75" y="154.7236">add</text><rect fill="#000000" filter="url(#fcrgj7ubn2ra6)" height="6" rx="2.5" ry="2.5" style="stroke: #000000; stroke-width: 1.0;" width="1408.5" x="10" y="187.3604"/><rect fill="#FEFECE" filter="url(#fcrgj7ubn2ra6)" height="36.3887" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="173" x="22" y="417.0237"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="153" x="32" y="440.7756">ElanInterfaceConfigListener</text><ellipse cx="108.5" cy="499.4124" fill="#FFFFFF" filter="url(#fcrgj7ubn2ra6)" rx="11" ry="11" style="stroke: #000000; stroke-width: 1.0;"/><ellipse cx="108.5" cy="499.4124" fill="#000000" rx="6" ry="6" style="stroke: #7F7F7F; stroke-width: 1.0;"/><rect fill="#FEFECE" filter="url(#fcrgj7ubn2ra6)" height="36.3887" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="128" x="205" y="417.0237"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="108" x="215" y="440.7756">AclInterfaceListener</text><ellipse cx="269" cy="499.4124" fill="#FFFFFF" filter="url(#fcrgj7ubn2ra6)" rx="11" ry="11" style="stroke: #000000; stroke-width: 1.0;"/><ellipse cx="269" cy="499.4124" fill="#000000" rx="6" ry="6" style="stroke: #7F7F7F; stroke-width: 1.0;"/><rect fill="#FEFECE" filter="url(#fcrgj7ubn2ra6)" height="36.3887" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="149" x="343" y="417.0237"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="129" x="353" y="440.7756">HwVTEPConfigListener</text><ellipse cx="417.5" cy="499.4124" fill="#FFFFFF" filter="url(#fcrgj7ubn2ra6)" rx="11" ry="11" style="stroke: #000000; stroke-width: 1.0;"/><ellipse cx="417.5" cy="499.4124" fill="#000000" rx="6" ry="6" style="stroke: #7F7F7F; stroke-width: 1.0;"/><rect fill="#FEFECE" filter="url(#fcrgj7ubn2ra6)" height="36.3887" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="148" x="702.5" y="253.6147"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="128" x="712.5" y="277.3667">InterfaceConfigListener</text><rect fill="#FEFECE" filter="url(#fcrgj7ubn2ra6)" height="36.3887" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="425" x="564" y="325.0034"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="405" x="574" y="348.7554">ovsInterfaceConfigAddHelper.addConfiguration(parentRefs, interfaceNew)</text><path d="M502,396.3921 L502,459.6553 A0,0 0 0 0 502,459.6553 L621,459.6553 A0,0 0 0 0 621,459.6553 L621,432.0237 L641,428.0237 L621,424.0237 L621,406.3921 L611,396.3921 L502,396.3921 A0,0 0 0 0 502,396.3921 " fill="#FBFB77" filter="url(#fcrgj7ubn2ra6)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M611,396.3921 L611,406.3921 L621,406.3921 L611,396.3921 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="98" x="508" y="416.29">&#x53EA;&#x5904;&#x7406;trunk &#x53E3;&#xFF1B;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="94" x="508" y="434.0444">&#x4E0E;&#x7236;&#x63A5;&#x53E3;&#x7684;state</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="26" x="508" y="451.7988">&#x4E00;&#x81F4;</text><rect fill="#FEFECE" filter="url(#fcrgj7ubn2ra6)" height="36.3887" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="271" x="641" y="409.8293"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="251" x="651" y="433.5813">interfaceManagerCommonUtils.addStateEntry</text><rect fill="#00B2EE" filter="url(#fcrgj7ubn2ra6)" height="36.3887" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="247" x="653" y="494.6553"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="227" x="663" y="518.4072">operational/ietf-interfaces:interfaces-state</text><rect fill="#EE3B3B" filter="url(#fcrgj7ubn2ra6)" height="36.3887" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="123" x="715" y="566.0439"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="103" x="725" y="589.7959">install ingress flow</text><rect fill="#00B2EE" filter="url(#fcrgj7ubn2ra6)" height="36.3887" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="223" x="665" y="637.4326"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="203" x="675" y="661.1846">Update the DpnToInterfaceList OpDS</text><rect fill="#FEFECE" filter="url(#fcrgj7ubn2ra6)" height="36.3887" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="170" x="1186" y="213.3604"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="150" x="1196" y="237.1123">VlanMemberConfigListener</text><path d="M1056,289.0662 L1056,316.8206 A0,0 0 0 0 1056,316.8206 L1157,316.8206 A0,0 0 0 0 1157,316.8206 L1157,307.0662 L1177,302.9434 L1157,299.0662 L1157,299.0662 L1147,289.0662 L1056,289.0662 A0,0 0 0 0 1056,289.0662 " fill="#FBFB77" filter="url(#fcrgj7ubn2ra6)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M1147,289.0662 L1147,299.0662 L1157,299.0662 L1147,289.0662 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="80" x="1062" y="308.9641">&#x53EA;&#x5904;&#x7406;elan &#x53E3;</text><rect fill="#FEFECE" filter="url(#fcrgj7ubn2ra6)" height="36.3887" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="188" x="1177" y="284.749"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="168" x="1187" y="308.501">addVlanMember(newInterface)</text><path d="M999,356.1377 L999,419.4009 A0,0 0 0 0 999,419.4009 L1137,419.4009 A0,0 0 0 0 1137,419.4009 L1137,391.7693 L1157,387.7693 L1137,383.7693 L1137,366.1377 L1127,356.1377 L999,356.1377 A0,0 0 0 0 999,356.1377 " fill="#FBFB77" filter="url(#fcrgj7ubn2ra6)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M1127,356.1377 L1127,366.1377 L1137,366.1377 L1127,356.1377 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="117" x="1005" y="376.0356">&#x56DE;&#x8C03;&#x5904;&#x7406;&#xFF0C;&#x5F53;&#x7236;&#x63A5;&#x53E3;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="80" x="1005" y="393.79">&#x7684;Op state &#x5E93;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="117" x="1005" y="411.5444">&#x6709;&#x6DFB;&#x52A0;&#x6216;&#x66F4;&#x65B0;&#x65F6;&#x89E6;&#x53D1;</text><rect fill="#FEFECE" filter="url(#fcrgj7ubn2ra6)" height="52.7773" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="228" x="1157" y="361.3806"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="185" x="1167" y="385.1326">ovsVlanMemberConfigAddHelper.</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="205" x="1170" y="401.5212">addConfiguration(parentRefs, added)</text><path d="M1000.5,454.4009 L1000.5,499.9097 A0,0 0 0 0 1000.5,499.9097 L1115.5,499.9097 A0,0 0 0 0 1115.5,499.9097 L1115.5,481.1553 L1135.5,477.1553 L1115.5,473.1553 L1115.5,464.4009 L1105.5,454.4009 L1000.5,454.4009 A0,0 0 0 0 1000.5,454.4009 " fill="#FBFB77" filter="url(#fcrgj7ubn2ra6)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M1105.5,454.4009 L1105.5,464.4009 L1115.5,464.4009 L1105.5,454.4009 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="94" x="1006.5" y="474.2988">&#x4E0E;&#x7236;&#x63A5;&#x53E3;&#x7684;state</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="26" x="1006.5" y="492.0532">&#x4E00;&#x81F4;</text><rect fill="#FEFECE" filter="url(#fcrgj7ubn2ra6)" height="36.3887" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="271" x="1135.5" y="458.9609"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="251" x="1145.5" y="482.7129">interfaceManagerCommonUtils.addStateEntry</text><rect fill="#00B2EE" filter="url(#fcrgj7ubn2ra6)" height="36.3887" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="247" x="1147.5" y="534.9097"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="227" x="1157.5" y="558.6616">operational/ietf-interfaces:interfaces-state</text><rect fill="#EE3B3B" filter="url(#fcrgj7ubn2ra6)" height="36.3887" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="123" x="1209.5" y="606.2983"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="103" x="1219.5" y="630.0503">install ingress flow</text><rect fill="#00B2EE" filter="url(#fcrgj7ubn2ra6)" height="36.3887" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="223" x="1159.5" y="677.687"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="203" x="1169.5" y="701.439">Update the DpnToInterfaceList OpDS</text><rect fill="#000000" filter="url(#fcrgj7ubn2ra6)" height="6" rx="2.5" ry="2.5" style="stroke: #000000; stroke-width: 1.0;" width="1408.5" x="10" y="734.0757"/><ellipse cx="696.25" cy="770.0757" fill="#FFFFFF" filter="url(#fcrgj7ubn2ra6)" rx="10" ry="10" style="stroke: #000000; stroke-width: 1.5;"/><line style="stroke: #000000; stroke-width: 2.5;" x1="690.0628" x2="702.4372" y1="763.8885" y2="776.2629"/><line style="stroke: #000000; stroke-width: 2.5;" x1="702.4372" x2="690.0628" y1="763.8885" y2="776.2629"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="696.25" x2="696.25" y1="54.583" y2="74.583"/><polygon fill="#A80036" points="692.25,64.583,696.25,74.583,700.25,64.583,696.25,68.583" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="696.25" x2="696.25" y1="110.9717" y2="130.9717"/><polygon fill="#A80036" points="692.25,120.9717,696.25,130.9717,700.25,120.9717,696.25,124.9717" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="108.5" x2="108.5" y1="453.4124" y2="488.4124"/><polygon fill="#A80036" points="104.5,478.4124,108.5,488.4124,112.5,478.4124,108.5,482.4124" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="269" x2="269" y1="453.4124" y2="488.4124"/><polygon fill="#A80036" points="265,478.4124,269,488.4124,273,478.4124,269,482.4124" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="417.5" x2="417.5" y1="453.4124" y2="488.4124"/><polygon fill="#A80036" points="413.5,478.4124,417.5,488.4124,421.5,478.4124,417.5,482.4124" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="776.5" x2="776.5" y1="290.0034" y2="325.0034"/><polygon fill="#A80036" points="772.5,315.0034,776.5,325.0034,780.5,315.0034,776.5,319.0034" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="776.5" x2="776.5" y1="361.3921" y2="409.8293"/><polygon fill="#A80036" points="772.5,399.8293,776.5,409.8293,780.5,399.8293,776.5,403.8293" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="776.5" x2="776.5" y1="446.218" y2="494.6553"/><polygon fill="#A80036" points="772.5,484.6553,776.5,494.6553,780.5,484.6553,776.5,488.6553" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="776.5" x2="776.5" y1="531.0439" y2="566.0439"/><polygon fill="#A80036" points="772.5,556.0439,776.5,566.0439,780.5,556.0439,776.5,560.0439" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="776.5" x2="776.5" y1="602.4326" y2="637.4326"/><polygon fill="#A80036" points="772.5,627.4326,776.5,637.4326,780.5,627.4326,776.5,631.4326" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="1271" x2="1271" y1="249.749" y2="284.749"/><polygon fill="#A80036" points="1267,274.749,1271,284.749,1275,274.749,1271,278.749" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="1271" x2="1271" y1="321.1377" y2="361.3806"/><polygon fill="#A80036" points="1267,351.3806,1271,361.3806,1275,351.3806,1271,355.3806" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="1271" x2="1271" y1="414.158" y2="458.9609"/><polygon fill="#A80036" points="1267,448.9609,1271,458.9609,1275,448.9609,1271,452.9609" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="1271" x2="1271" y1="495.3496" y2="534.9097"/><polygon fill="#A80036" points="1267,524.9097,1271,534.9097,1275,524.9097,1271,528.9097" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="1271" x2="1271" y1="571.2983" y2="606.2983"/><polygon fill="#A80036" points="1267,596.2983,1271,606.2983,1275,596.2983,1271,600.2983" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="1271" x2="1271" y1="642.687" y2="677.687"/><polygon fill="#A80036" points="1267,667.687,1271,677.687,1275,667.687,1271,671.687" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="108.5" x2="108.5" y1="193.3604" y2="417.0237"/><polygon fill="#A80036" points="104.5,407.0237,108.5,417.0237,112.5,407.0237,108.5,411.0237" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="269" x2="269" y1="193.3604" y2="417.0237"/><polygon fill="#A80036" points="265,407.0237,269,417.0237,273,407.0237,269,411.0237" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="417.5" x2="417.5" y1="193.3604" y2="417.0237"/><polygon fill="#A80036" points="413.5,407.0237,417.5,417.0237,421.5,407.0237,417.5,411.0237" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="776.5" x2="776.5" y1="193.3604" y2="253.6147"/><polygon fill="#A80036" points="772.5,243.6147,776.5,253.6147,780.5,243.6147,776.5,247.6147" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="1271" x2="1271" y1="193.3604" y2="213.3604"/><polygon fill="#A80036" points="1267,203.3604,1271,213.3604,1275,203.3604,1271,207.3604" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="776.5" x2="776.5" y1="673.8213" y2="734.0757"/><polygon fill="#A80036" points="772.5,724.0757,776.5,734.0757,780.5,724.0757,776.5,728.0757" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="1271" x2="1271" y1="714.0757" y2="734.0757"/><polygon fill="#A80036" points="1267,724.0757,1271,734.0757,1275,724.0757,1271,728.0757" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="696.25" x2="696.25" y1="167.3604" y2="187.3604"/><polygon fill="#A80036" points="692.25,177.3604,696.25,187.3604,700.25,177.3604,696.25,181.3604" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="696.25" x2="696.25" y1="740.0757" y2="760.0757"/><polygon fill="#A80036" points="692.25,750.0757,696.25,760.0757,700.25,750.0757,696.25,754.0757" style="stroke: #A80036; stroke-width: 1.0;"/><!--
@startuml
title ietf interface创建
start
    #99FF99:interfaces/interface/interface;
    :add; 
    fork
        :ElanInterfaceConfigListener;
        stop
    fork again
        :AclInterfaceListener;
        stop
    fork again
        :HwVTEPConfigListener;
        stop
    fork again
        :InterfaceConfigListener;
        :ovsInterfaceConfigAddHelper.addConfiguration(parentRefs, interfaceNew);
        :interfaceManagerCommonUtils.addStateEntry;
        note left
            只处理trunk 口；
            与父接口的state
            一致
        end note
        #00B2EE:operational/ietf-interfaces:interfaces-state;
        #EE3B3B:install ingress flow;
        #00B2EE:Update the DpnToInterfaceList OpDS;

    fork again
        :VlanMemberConfigListener;
        :addVlanMember(newInterface);
        note left
            只处理elan 口
        end note
        :ovsVlanMemberConfigAddHelper.\n addConfiguration(parentRefs, added);
        note left
            回调处理，当父接口
            的Op state 库
            有添加或更新时触发
        end note
        :interfaceManagerCommonUtils.addStateEntry;
        note left
            与父接口的state
            一致
        end note
        #00B2EE:operational/ietf-interfaces:interfaces-state;
        #EE3B3B:install ingress flow;
        #00B2EE:Update the DpnToInterfaceList OpDS;
    end fork
        
end

@enduml

PlantUML version 1.2019.07(Tue Jun 25 03:59:20 CST 2019)
(MIT source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) 64-Bit Server VM
Java Version: 1.8.0_191-b12
Operating System: Windows 10
OS Version: 10.0
Default Encoding: GBK
Language: zh
Country: CN
--></g></svg></p><hr>
<p style="text-align: center;"><strong>&#x7B2C;&#x4E09;&#x6B65;&#xFF1A;elan interface &#x521B;&#x5EFA;</strong></p>
<p><!--?xml version="1.0" encoding="UTF-8" standalone="no"?--><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" contentscripttype="application/ecmascript" contentstyletype="text/css" height="394px" preserveAspectRatio="none" style="width:935px;height:394px;" version="1.1" viewBox="0 0 935 394" width="935px" zoomAndPan="magnify"><defs><filter height="300%" id="fhir51gkkohjh" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><text fill="#000000" font-family="sans-serif" font-size="18" lengthAdjust="spacingAndGlyphs" textLength="144" x="394.5" y="30.6279">elan interface&#x521B;&#x5EFA;</text><ellipse cx="476" cy="44.583" fill="#000000" filter="url(#fhir51gkkohjh)" rx="10" ry="10" style="stroke: none; stroke-width: 1.0;"/><rect fill="#99FF99" filter="url(#fhir51gkkohjh)" height="36.3887" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="258" x="347" y="74.583"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="238" x="357" y="98.335">elan-interfaces/elan-interface/elan-interface</text><rect fill="#FEFECE" filter="url(#fhir51gkkohjh)" height="36.3887" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="41" x="455.5" y="130.9717"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="21" x="465.5" y="154.7236">add</text><rect fill="#000000" filter="url(#fhir51gkkohjh)" height="6" rx="2.5" ry="2.5" style="stroke: #000000; stroke-width: 1.0;" width="914" x="10" y="187.3604"/><path d="M22,215.9946 L22,261.5034 A0,0 0 0 0 22,261.5034 L121,261.5034 A0,0 0 0 0 121,261.5034 L121,242.749 L141,238.749 L121,234.749 L121,225.9946 L111,215.9946 L22,215.9946 A0,0 0 0 0 22,215.9946 " fill="#FBFB77" filter="url(#fhir51gkkohjh)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M111,215.9946 L111,225.9946 L121,225.9946 L111,215.9946 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="78" x="28" y="235.8926">&#x53EA;&#x9488;&#x5BF9;&#x5916;&#x90E8;&#x7F51;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="78" x="28" y="253.647">&#x7EDC;&#x7684;&#x63A5;&#x53E3;&#x5904;&#x7406;</text><rect fill="#FEFECE" filter="url(#fhir51gkkohjh)" height="36.3887" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="202" x="141" y="220.5547"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="182" x="151" y="244.3066">VpnElanInterfaceChangeListener</text><ellipse cx="242" cy="304.2578" fill="#FFFFFF" filter="url(#fhir51gkkohjh)" rx="11" ry="11" style="stroke: #000000; stroke-width: 1.0;"/><ellipse cx="242" cy="304.2578" fill="#000000" rx="6" ry="6" style="stroke: #7F7F7F; stroke-width: 1.0;"/><rect fill="#FEFECE" filter="url(#fhir51gkkohjh)" height="36.3887" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="153" x="371" y="220.5547"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="133" x="381" y="244.3066">AclElanInterfaceListener</text><ellipse cx="447.5" cy="299.6978" fill="#FFFFFF" filter="url(#fhir51gkkohjh)" rx="11" ry="11" style="stroke: #000000; stroke-width: 1.0;"/><ellipse cx="447.5" cy="299.6978" fill="#000000" rx="6" ry="6" style="stroke: #7F7F7F; stroke-width: 1.0;"/><rect fill="#FEFECE" filter="url(#fhir51gkkohjh)" height="36.3887" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="117" x="552" y="213.3604"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="97" x="562" y="237.1123">DataObjectCache</text><rect fill="#FEFECE" filter="url(#fhir51gkkohjh)" height="36.3887" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="68" x="576.5" y="281.5034"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="48" x="586.5" y="305.2554">&#x7F13;&#x5B58;&#x5904;&#x7406;</text><path d="M679,217.6775 L679,245.4319 A0,0 0 0 0 679,245.4319 L752,245.4319 A0,0 0 0 0 752,245.4319 L752,235.6775 L772,231.5547 L752,227.6775 L752,227.6775 L742,217.6775 L679,217.6775 A0,0 0 0 0 679,217.6775 " fill="#FBFB77" filter="url(#fhir51gkkohjh)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M742,217.6775 L742,227.6775 L752,227.6775 L742,217.6775 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="52" x="685" y="237.5754">&#x5173;&#x952E;&#x903B;&#x8F91;</text><rect fill="#FEFECE" filter="url(#fhir51gkkohjh)" height="36.3887" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="140" x="772" y="213.3604"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="120" x="782" y="237.1123">ElanInterfaceManager</text><rect fill="#FEFECE" filter="url(#fhir51gkkohjh)" height="36.3887" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="56" x="814" y="281.5034"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="36" x="824" y="305.2554">&#x63A5;&#x4E0B;&#x56FE;</text><rect fill="#000000" filter="url(#fhir51gkkohjh)" height="6" rx="2.5" ry="2.5" style="stroke: #000000; stroke-width: 1.0;" width="914" x="10" y="337.8921"/><ellipse cx="476" cy="373.8921" fill="#FFFFFF" filter="url(#fhir51gkkohjh)" rx="10" ry="10" style="stroke: #000000; stroke-width: 1.5;"/><line style="stroke: #000000; stroke-width: 2.5;" x1="469.8128" x2="482.1872" y1="367.7049" y2="380.0793"/><line style="stroke: #000000; stroke-width: 2.5;" x1="482.1872" x2="469.8128" y1="367.7049" y2="380.0793"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="476" x2="476" y1="54.583" y2="74.583"/><polygon fill="#A80036" points="472,64.583,476,74.583,480,64.583,476,68.583" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="476" x2="476" y1="110.9717" y2="130.9717"/><polygon fill="#A80036" points="472,120.9717,476,130.9717,480,120.9717,476,124.9717" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="242" x2="242" y1="256.9434" y2="293.2578"/><polygon fill="#A80036" points="238,283.2578,242,293.2578,246,283.2578,242,287.2578" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="447.5" x2="447.5" y1="256.9434" y2="288.6978"/><polygon fill="#A80036" points="443.5,278.6978,447.5,288.6978,451.5,278.6978,447.5,282.6978" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="610.5" x2="610.5" y1="249.749" y2="281.5034"/><polygon fill="#A80036" points="606.5,271.5034,610.5,281.5034,614.5,271.5034,610.5,275.5034" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="842" x2="842" y1="249.749" y2="281.5034"/><polygon fill="#A80036" points="838,271.5034,842,281.5034,846,271.5034,842,275.5034" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="242" x2="242" y1="193.3604" y2="220.5547"/><polygon fill="#A80036" points="238,210.5547,242,220.5547,246,210.5547,242,214.5547" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="447.5" x2="447.5" y1="193.3604" y2="220.5547"/><polygon fill="#A80036" points="443.5,210.5547,447.5,220.5547,451.5,210.5547,447.5,214.5547" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="610.5" x2="610.5" y1="193.3604" y2="213.3604"/><polygon fill="#A80036" points="606.5,203.3604,610.5,213.3604,614.5,203.3604,610.5,207.3604" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="842" x2="842" y1="193.3604" y2="213.3604"/><polygon fill="#A80036" points="838,203.3604,842,213.3604,846,203.3604,842,207.3604" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="610.5" x2="610.5" y1="317.8921" y2="337.8921"/><polygon fill="#A80036" points="606.5,327.8921,610.5,337.8921,614.5,327.8921,610.5,331.8921" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="842" x2="842" y1="317.8921" y2="337.8921"/><polygon fill="#A80036" points="838,327.8921,842,337.8921,846,327.8921,842,331.8921" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="476" x2="476" y1="167.3604" y2="187.3604"/><polygon fill="#A80036" points="472,177.3604,476,187.3604,480,177.3604,476,181.3604" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="476" x2="476" y1="343.8921" y2="363.8921"/><polygon fill="#A80036" points="472,353.8921,476,363.8921,480,353.8921,476,357.8921" style="stroke: #A80036; stroke-width: 1.0;"/><!--
@startuml
title elan interface创建
start
    #99FF99:elan-interfaces/elan-interface/elan-interface;
    :add; 
    fork
        :VpnElanInterfaceChangeListener;
        note left
            只针对外部网
            络的接口处理
        end note
        stop
    fork again
        :AclElanInterfaceListener;
        stop
    fork again
        :DataObjectCache;
        :缓存处理;
    fork again
        :ElanInterfaceManager;
        note left 
            关键逻辑
        end note
        :接下图;
    end fork
        
end

@enduml

PlantUML version 1.2019.07(Tue Jun 25 03:59:20 CST 2019)
(MIT source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) 64-Bit Server VM
Java Version: 1.8.0_191-b12
Operating System: Windows 10
OS Version: 10.0
Default Encoding: GBK
Language: zh
Country: CN
--></g></svg></p><hr>
<p style="text-align: center;"><strong>&#x7B2C;&#x4E09;&#x6B65;&#x7EED;&#xFF1A;elan interface &#x521B;&#x5EFA;</strong></p>
<p><!--?xml version="1.0" encoding="UTF-8" standalone="no"?--><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" contentscripttype="application/ecmascript" contentstyletype="text/css" height="1668px" preserveAspectRatio="none" style="width:1540px;height:1668px;" version="1.1" viewBox="0 0 1540 1668" width="1540px" zoomAndPan="magnify"><defs><filter height="300%" id="f61418nd7mc8v" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="90" x="725.75" y="26.0439">vlan&#x7F51;&#x7EDC;&#x521B;&#x5EFA;</text><rect fill="#8B8989" filter="url(#f61418nd7mc8v)" height="1484.6968" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="135.5" y="115.9946"/><rect fill="#FFFFFF" filter="url(#f61418nd7mc8v)" height="201.8179" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="135.5" y="115.9946"/><rect fill="#FFFFFF" filter="url(#f61418nd7mc8v)" height="51.5317" style="stroke: #000000; stroke-width: 2.0;" width="678.5" x="47" y="135.9946"/><rect fill="#FFFFFF" filter="url(#f61418nd7mc8v)" height="109.2861" style="stroke: #000000; stroke-width: 2.0;" width="504.5" x="47" y="201.5264"/><rect fill="#FFFFFF" filter="url(#f61418nd7mc8v)" height="98.2861" style="stroke: #000000; stroke-width: 2.0;" width="678.5" x="47" y="388.3213"/><rect fill="#FFFFFF" height="46.7544" style="stroke: none; stroke-width: 1.0;" width="678.5" x="47" y="439.853"/><rect fill="#FFFFFF" filter="url(#f61418nd7mc8v)" height="260.104" style="stroke: #000000; stroke-width: 2.0;" width="1062.5" x="27" y="500.6074"/><rect fill="#FFFFFF" filter="url(#f61418nd7mc8v)" height="226.3267" style="stroke: #000000; stroke-width: 2.0;" width="1042.5" x="37" y="527.3848"/><rect fill="#FFFFFF" filter="url(#f61418nd7mc8v)" height="82.2861" style="stroke: #000000; stroke-width: 2.0;" width="549.5" x="47" y="554.1621"/><rect fill="#FFFFFF" height="78.5088" style="stroke: none; stroke-width: 1.0;" width="1042.5" x="37" y="675.2026"/><rect fill="#FFFFFF" filter="url(#f61418nd7mc8v)" height="130.0635" style="stroke: #000000; stroke-width: 2.0;" width="1260.5" x="37" y="953.729"/><rect fill="#FFFFFF" filter="url(#f61418nd7mc8v)" height="96.2861" style="stroke: #000000; stroke-width: 2.0;" width="1240.5" x="47" y="980.5063"/><rect fill="#FFFFFF" filter="url(#f61418nd7mc8v)" height="64.5317" style="stroke: #000000; stroke-width: 2.0;" width="484" x="12" y="1097.7925"/><rect fill="#FFFFFF" filter="url(#f61418nd7mc8v)" height="221.5952" style="stroke: #000000; stroke-width: 2.0;" width="389.5" x="37" y="1342.3418"/><rect fill="#FFFFFF" filter="url(#f61418nd7mc8v)" height="64.5317" style="stroke: #000000; stroke-width: 2.0;" width="369.5" x="47" y="1369.1191"/><rect fill="#FFFFFF" filter="url(#f61418nd7mc8v)" height="64.5317" style="stroke: #000000; stroke-width: 2.0;" width="356.5" x="47" y="1492.4053"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="135" x2="135" y1="74.2402" y2="1625.6914"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="679.5" x2="679.5" y1="74.2402" y2="1625.6914"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="820.5" x2="820.5" y1="74.2402" y2="1625.6914"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="997.5" x2="997.5" y1="74.2402" y2="1625.6914"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1178.5" x2="1178.5" y1="74.2402" y2="1625.6914"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1410.5" x2="1410.5" y1="74.2402" y2="1625.6914"/><rect fill="#FEFECE" filter="url(#f61418nd7mc8v)" height="33.1201" style="stroke: #A80036; stroke-width: 1.5;" width="153" x="57" y="36.1201"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="139" x="64" y="59.1641">ElanInterfaceManager</text><rect fill="#FEFECE" filter="url(#f61418nd7mc8v)" height="33.1201" style="stroke: #A80036; stroke-width: 1.5;" width="153" x="57" y="1624.6914"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="139" x="64" y="1647.7354">ElanInterfaceManager</text><rect fill="#FEFECE" filter="url(#f61418nd7mc8v)" height="33.1201" style="stroke: #A80036; stroke-width: 1.5;" width="68" x="643.5" y="36.1201"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="54" x="650.5" y="59.1641">ElanUtils</text><rect fill="#FEFECE" filter="url(#f61418nd7mc8v)" height="33.1201" style="stroke: #A80036; stroke-width: 1.5;" width="68" x="643.5" y="1624.6914"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="54" x="650.5" y="1647.7354">ElanUtils</text><rect fill="#FEFECE" filter="url(#f61418nd7mc8v)" height="33.1201" style="stroke: #A80036; stroke-width: 1.5;" width="187" x="725.5" y="36.1201"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="173" x="732.5" y="59.1641">InterfaceAddWorkerOnElan</text><rect fill="#FEFECE" filter="url(#f61418nd7mc8v)" height="33.1201" style="stroke: #A80036; stroke-width: 1.5;" width="187" x="725.5" y="1624.6914"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="173" x="732.5" y="1647.7354">InterfaceAddWorkerOnElan</text><rect fill="#FEFECE" filter="url(#f61418nd7mc8v)" height="33.1201" style="stroke: #A80036; stroke-width: 1.5;" width="139" x="926.5" y="36.1201"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="125" x="933.5" y="59.1641">ElanL2GatewayUtils</text><rect fill="#FEFECE" filter="url(#f61418nd7mc8v)" height="33.1201" style="stroke: #A80036; stroke-width: 1.5;" width="139" x="926.5" y="1624.6914"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="125" x="933.5" y="1647.7354">ElanL2GatewayUtils</text><rect fill="#FEFECE" filter="url(#f61418nd7mc8v)" height="33.1201" style="stroke: #A80036; stroke-width: 1.5;" width="194" x="1079.5" y="36.1201"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="180" x="1086.5" y="59.1641">ElanL2GatewayMulticastUtils</text><rect fill="#FEFECE" filter="url(#f61418nd7mc8v)" height="33.1201" style="stroke: #A80036; stroke-width: 1.5;" width="194" x="1079.5" y="1624.6914"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="180" x="1086.5" y="1647.7354">ElanL2GatewayMulticastUtils</text><rect fill="#FEFECE" filter="url(#f61418nd7mc8v)" height="33.1201" style="stroke: #A80036; stroke-width: 1.5;" width="242" x="1287.5" y="36.1201"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="228" x="1294.5" y="59.1641">InterfaceAddWorkerOnElanInterface</text><rect fill="#FEFECE" filter="url(#f61418nd7mc8v)" height="33.1201" style="stroke: #A80036; stroke-width: 1.5;" width="242" x="1287.5" y="1624.6914"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="228" x="1294.5" y="1647.7354">InterfaceAddWorkerOnElanInterface</text><rect fill="#8B8989" filter="url(#f61418nd7mc8v)" height="1484.6968" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="135.5" y="115.9946"/><rect fill="#FFFFFF" filter="url(#f61418nd7mc8v)" height="201.8179" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="135.5" y="115.9946"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="135.5" x2="182.5" y1="102.9946" y2="102.9946"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="182.5" x2="182.5" y1="102.9946" y2="115.9946"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="141.5" x2="182.5" y1="115.9946" y2="115.9946"/><polygon fill="#A80036" points="151.5,111.9946,141.5,115.9946,151.5,119.9946,147.5,115.9946" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="21" x="147.5" y="98.1382">add</text><path d="M47,135.9946 L108,135.9946 L108,144.9946 L98,154.9946 L47,154.9946 L47,135.9946 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="51.5317" style="stroke: #000000; stroke-width: 2.0;" width="678.5" x="47" y="135.9946"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="16" x="62" y="151.8926">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="122" x="123" y="150.6006">[elanInstance not exit]</text><polygon fill="#A80036" points="667.5,175.5264,677.5,179.5264,667.5,183.5264,671.5,179.5264" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="145.5" x2="673.5" y1="179.5264" y2="179.5264"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="244" x="152.5" y="174.6699">updateOperationalDataStore(elanInstance)</text><path d="M47,201.5264 L108,201.5264 L108,210.5264 L98,220.5264 L47,220.5264 L47,201.5264 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="109.2861" style="stroke: #000000; stroke-width: 2.0;" width="504.5" x="47" y="201.5264"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="16" x="62" y="217.4243">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="133" x="123" y="216.1323">[elan tag is not updated]</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="145.5" x2="187.5" y1="245.0581" y2="245.0581"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="187.5" x2="187.5" y1="245.0581" y2="258.0581"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="146.5" x2="187.5" y1="258.0581" y2="258.0581"/><polygon fill="#A80036" points="156.5,254.0581,146.5,258.0581,156.5,262.0581,152.5,258.0581" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="387" x="152.5" y="240.2017">unProcessedElanInterfaces.put(elanInstanceName, elanInterfaces);</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="145.5" x2="187.5" y1="289.8125" y2="289.8125"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="187.5" x2="187.5" y1="289.8125" y2="302.8125"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="146.5" x2="187.5" y1="302.8125" y2="302.8125"/><polygon fill="#A80036" points="156.5,298.8125,146.5,302.8125,156.5,306.8125,152.5,302.8125" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="59" x="152.5" y="284.9561">return void</text><polygon fill="#A80036" points="809,337.5669,819,341.5669,809,345.5669,813,341.5669" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="140.5" x2="815" y1="341.5669" y2="341.5669"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="80" x="147.5" y="336.7104">call(&#x961F;&#x5217;&#x6267;&#x884C;)</text><polygon fill="#A80036" points="151.5,369.3213,141.5,373.3213,151.5,377.3213,147.5,373.3213" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="145.5" x2="820" y1="373.3213" y2="373.3213"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="96" x="157.5" y="368.4648">addElanInterface</text><path d="M47,388.3213 L108,388.3213 L108,397.3213 L98,407.3213 L47,407.3213 L47,388.3213 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="98.2861" style="stroke: #000000; stroke-width: 2.0;" width="678.5" x="47" y="388.3213"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="16" x="62" y="404.2192">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="84" x="123" y="402.9272">[elanInfo==null]</text><polygon fill="#A80036" points="667.5,427.853,677.5,431.853,667.5,435.853,671.5,431.853" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="140.5" x2="673.5" y1="431.853" y2="431.853"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="428" x="147.5" y="426.9966">updateOperationalDataStore(idManager, elanInstance, elanInterfaces, tx) &quot;</text><text fill="#00B2EE" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="70" x="579.5" y="426.9966">&#x66F4;&#x65B0;&#x64CD;&#x4F5C;&#x5E93;</text><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="47" x2="725.5" y1="440.853" y2="440.853"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="140.5" x2="182.5" y1="465.6074" y2="465.6074"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="182.5" x2="182.5" y1="465.6074" y2="478.6074"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="141.5" x2="182.5" y1="478.6074" y2="478.6074"/><polygon fill="#A80036" points="151.5,474.6074,141.5,478.6074,151.5,482.6074,147.5,478.6074" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="348" x="147.5" y="460.751">createElanStateList(elanInstanceName, interfaceName, tx) &quot;</text><text fill="#00B2EE" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="168" x="499.5" y="460.751">&#x66F4;&#x65B0;&#x64CD;&#x4F5C;&#x5E93; elan:elan-state</text><path d="M27,500.6074 L88,500.6074 L88,509.6074 L78,519.6074 L27,519.6074 L27,500.6074 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="260.104" style="stroke: #000000; stroke-width: 2.0;" width="1062.5" x="27" y="500.6074"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="16" x="42" y="516.5054">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="312" x="103" y="515.2134">[dpId != null &amp;&amp; !dpId.equals(ElanConstants.INVALID_DPN]</text><path d="M37,527.3848 L98,527.3848 L98,536.3848 L88,546.3848 L37,546.3848 L37,527.3848 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="226.3267" style="stroke: #000000; stroke-width: 2.0;" width="1042.5" x="37" y="527.3848"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="16" x="52" y="543.2827">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="123" x="113" y="541.9907">[isFirstInterfaceInDpn]</text><path d="M47,554.1621 L108,554.1621 L108,563.1621 L98,573.1621 L47,573.1621 L47,554.1621 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="82.2861" style="stroke: #000000; stroke-width: 2.0;" width="549.5" x="47" y="554.1621"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="16" x="62" y="570.0601">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="266" x="123" y="568.7681">[isVxlanNetworkOrVxlanSegment(elanInstance)]</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="140.5" x2="182.5" y1="615.4482" y2="615.4482"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="182.5" x2="182.5" y1="615.4482" y2="628.4482"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="141.5" x2="182.5" y1="628.4482" y2="628.4482"/><polygon fill="#A80036" points="151.5,624.4482,141.5,628.4482,151.5,632.4482,147.5,628.4482" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="144" x="147.5" y="592.8374">setExternalTunnelTable &quot;</text><text fill="#EE3B3B" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="285" x="295.5" y="592.8374">table 38 &#x6D41;&#x8868;&#x76F8;&#x5173;&#xFF1B;The 1st ElanInterface in a</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="151.5" y="610.5918"/><text fill="#EE3B3B" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="406" x="155.5" y="610.5918">DPN must program the Ext Tunnel table, but only if Elan has VNI</text><polygon fill="#A80036" points="986,663.2026,996,667.2026,986,671.2026,990,667.2026" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="140.5" x2="992" y1="667.2026" y2="667.2026"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="240" x="147.5" y="662.3462">installElanL2gwDevicesLocalMacsInDpn &quot;</text><text fill="#EE3B3B" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="110" x="391.5" y="662.3462">table 51 &#x6D41;&#x8868;&#x76F8;&#x5173;</text><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="37" x2="1079.5" y1="676.2026" y2="676.2026"/><polygon fill="#A80036" points="986,696.957,996,700.957,986,704.957,990,700.957" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="140.5" x2="992" y1="700.957" y2="700.957"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="240" x="147.5" y="696.1006">installElanL2gwDevicesLocalMacsInDpn &quot;</text><text fill="#EE3B3B" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="110" x="391.5" y="696.1006">table 51 &#x6D41;&#x8868;&#x76F8;&#x5173;</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="140.5" x2="182.5" y1="732.7114" y2="732.7114"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="182.5" x2="182.5" y1="732.7114" y2="745.7114"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="141.5" x2="182.5" y1="745.7114" y2="745.7114"/><polygon fill="#A80036" points="151.5,741.7114,141.5,745.7114,151.5,749.7114,147.5,745.7114" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="178" x="147.5" y="727.855">updateElanDpnInterfacesList  &quot;</text><text fill="#00B2EE" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="228" x="329.5" y="727.855">&#x66F4;&#x65B0;&#x64CD;&#x4F5C;&#x5E93; elan:elan-dpn-interfaces</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="140.5" x2="182.5" y1="791.4658" y2="791.4658"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="182.5" x2="182.5" y1="791.4658" y2="804.4658"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="141.5" x2="182.5" y1="804.4658" y2="804.4658"/><polygon fill="#A80036" points="151.5,800.4658,141.5,804.4658,151.5,808.4658,147.5,804.4658" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="175" x="147.5" y="786.6094">createElanInterfaceTablesList&quot;</text><text fill="#00B2EE" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="314" x="326.5" y="786.6094">&#x66F4;&#x65B0;&#x64CD;&#x4F5C;&#x5E93; elan:elan-interface-forwarding-entries</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="140.5" x2="182.5" y1="836.2202" y2="836.2202"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="182.5" x2="182.5" y1="836.2202" y2="849.2202"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="141.5" x2="182.5" y1="849.2202" y2="849.2202"/><polygon fill="#A80036" points="151.5,845.2202,141.5,849.2202,151.5,853.2202,147.5,849.2202" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="206" x="147.5" y="831.3638">installEntriesForFirstInterfaceonDpn</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="140.5" x2="182.5" y1="880.9746" y2="880.9746"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="182.5" x2="182.5" y1="880.9746" y2="893.9746"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="141.5" x2="182.5" y1="893.9746" y2="893.9746"/><polygon fill="#A80036" points="151.5,889.9746,141.5,893.9746,151.5,897.9746,147.5,893.9746" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="225" x="147.5" y="876.1182">setupStandardLocalBroadcastGroups &quot;</text><text fill="#EE3B3B" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="104" x="376.5" y="876.1182">group local &#x76F8;&#x5173;</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="140.5" x2="182.5" y1="925.729" y2="925.729"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="182.5" x2="182.5" y1="925.729" y2="938.729"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="141.5" x2="182.5" y1="938.729" y2="938.729"/><polygon fill="#A80036" points="151.5,934.729,141.5,938.729,151.5,942.729,147.5,938.729" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="209" x="147.5" y="920.8726">setupLeavesLocalBroadcastGroups&quot;</text><text fill="#EE3B3B" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="215" x="360.5" y="920.8726">group local &#x76F8;&#x5173;&#xFF0C; etree &#x7F51;&#x7EDC;&#x6A21;&#x578B;</text><path d="M37,953.729 L98,953.729 L98,962.729 L88,972.729 L37,972.729 L37,953.729 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="130.0635" style="stroke: #000000; stroke-width: 2.0;" width="1260.5" x="37" y="953.729"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="16" x="52" y="969.627">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="329" x="113" y="968.335">[ElanUtils.isVlan(elanInstance) &amp;&amp; !elanInstance.isExternal()]</text><path d="M47,980.5063 L108,980.5063 L108,989.5063 L98,999.5063 L47,999.5063 L47,980.5063 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="96.2861" style="stroke: #000000; stroke-width: 2.0;" width="1240.5" x="47" y="980.5063"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="16" x="62" y="996.4043">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="299" x="123" y="995.1123">[interfaceManager.isExternalInterface(interfaceName)]</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="140.5" x2="182.5" y1="1024.0381" y2="1024.0381"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="182.5" x2="182.5" y1="1024.0381" y2="1037.0381"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="141.5" x2="182.5" y1="1037.0381" y2="1037.0381"/><polygon fill="#A80036" points="151.5,1033.0381,141.5,1037.0381,151.5,1041.0381,147.5,1037.0381" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="167" x="147.5" y="1019.1816">handleExternalInterfaceEvent</text><polygon fill="#A80036" points="1166.5,1064.7925,1176.5,1068.7925,1166.5,1072.7925,1170.5,1068.7925" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="140.5" x2="1172.5" y1="1068.7925" y2="1068.7925"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="216" x="147.5" y="1063.936">setupStandardElanBroadcastGroups&quot;</text><text fill="#EE3B3B" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="229" x="367.5" y="1063.936">group remote &#x76F8;&#x5173;&#xFF0C; etree &#x7F51;&#x7EDC;&#x6A21;&#x578B;</text><path d="M12,1097.7925 L73,1097.7925 L73,1106.7925 L63,1116.7925 L12,1116.7925 L12,1097.7925 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="64.5317" style="stroke: #000000; stroke-width: 2.0;" width="484" x="12" y="1097.7925"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="16" x="27" y="1113.6904">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="403" x="88" y="1112.3984">[isFirstInterfaceInDpn &amp;&amp; isVxlanNetworkOrVxlanSegment(elanInstance)]</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="140.5" x2="182.5" y1="1141.3242" y2="1141.3242"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="182.5" x2="182.5" y1="1141.3242" y2="1154.3242"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="141.5" x2="182.5" y1="1154.3242" y2="1154.3242"/><polygon fill="#A80036" points="151.5,1150.3242,141.5,1154.3242,151.5,1158.3242,147.5,1154.3242" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="340" x="147.5" y="1136.4678">setElanAndEtreeBCGrouponOtherDpns(elanInstance, dpId)</text><path d="M22,1124.0698 L22,1151.0698 L121,1151.0698 L121,1134.0698 L111,1124.0698 L22,1124.0698 " fill="#FBFB77" filter="url(#f61418nd7mc8v)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M111,1124.0698 L111,1134.0698 L121,1134.0698 L111,1124.0698 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="78" x="28" y="1143.9678">&#x8FD8;&#x6709;&#x4E00;&#x4E9B;&#x903B;&#x8F91;</text><polygon fill="#A80036" points="1398.5,1189.0786,1408.5,1193.0786,1398.5,1197.0786,1402.5,1193.0786" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="140.5" x2="1404.5" y1="1193.0786" y2="1193.0786"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="28" x="147.5" y="1188.2222">caLL</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="140.5" x2="182.5" y1="1224.833" y2="1224.833"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="182.5" x2="182.5" y1="1224.833" y2="1237.833"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="141.5" x2="182.5" y1="1237.833" y2="1237.833"/><polygon fill="#A80036" points="151.5,1233.833,141.5,1237.833,151.5,1241.833,147.5,1237.833" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="167" x="147.5" y="1219.9766">setupEntriesForElanInterface</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="140.5" x2="182.5" y1="1269.5874" y2="1269.5874"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="182.5" x2="182.5" y1="1269.5874" y2="1282.5874"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="141.5" x2="182.5" y1="1282.5874" y2="1282.5874"/><polygon fill="#A80036" points="151.5,1278.5874,141.5,1282.5874,151.5,1286.5874,147.5,1282.5874" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="169" x="147.5" y="1264.731">installEntriesForElanInterface</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="140.5" x2="182.5" y1="1314.3418" y2="1314.3418"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="182.5" x2="182.5" y1="1314.3418" y2="1327.3418"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="141.5" x2="182.5" y1="1327.3418" y2="1327.3418"/><polygon fill="#A80036" points="151.5,1323.3418,141.5,1327.3418,151.5,1331.3418,147.5,1327.3418" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="137" x="147.5" y="1309.4854">setupFilterEqualsTable&quot;</text><text fill="#EE3B3B" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="82" x="288.5" y="1309.4854">table 55 &#x76F8;&#x5173;</text><path d="M37,1342.3418 L98,1342.3418 L98,1351.3418 L88,1361.3418 L37,1361.3418 L37,1342.3418 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="221.5952" style="stroke: #000000; stroke-width: 2.0;" width="389.5" x="37" y="1342.3418"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="16" x="52" y="1358.2397">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="123" x="113" y="1356.9478">[isFirstInterfaceInDpn]</text><path d="M47,1369.1191 L108,1369.1191 L108,1378.1191 L98,1388.1191 L47,1388.1191 L47,1369.1191 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="64.5317" style="stroke: #000000; stroke-width: 2.0;" width="369.5" x="47" y="1369.1191"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="16" x="62" y="1385.0171">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="274" x="123" y="1383.7251">[(isVxlanNetworkOrVxlanSegment(elanInstance))]</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="140.5" x2="182.5" y1="1412.6509" y2="1412.6509"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="182.5" x2="182.5" y1="1412.6509" y2="1425.6509"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="141.5" x2="182.5" y1="1425.6509" y2="1425.6509"/><polygon fill="#A80036" points="151.5,1421.6509,141.5,1425.6509,151.5,1429.6509,147.5,1425.6509" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="171" x="147.5" y="1407.7944">setupTerminateServiceTable &quot;</text><text fill="#EE3B3B" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="82" x="322.5" y="1407.7944">table 36 &#x76F8;&#x5173;</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="140.5" x2="182.5" y1="1464.4053" y2="1464.4053"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="182.5" x2="182.5" y1="1464.4053" y2="1477.4053"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="141.5" x2="182.5" y1="1477.4053" y2="1477.4053"/><polygon fill="#A80036" points="151.5,1473.4053,141.5,1477.4053,151.5,1481.4053,147.5,1477.4053" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="155" x="147.5" y="1459.5488">setupUnknownDMacTable&quot;</text><text fill="#EE3B3B" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="82" x="306.5" y="1459.5488">table 52 &#x76F8;&#x5173;</text><path d="M47,1492.4053 L108,1492.4053 L108,1501.4053 L98,1511.4053 L47,1511.4053 L47,1492.4053 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="64.5317" style="stroke: #000000; stroke-width: 2.0;" width="356.5" x="47" y="1492.4053"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="16" x="62" y="1508.3032">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="214" x="123" y="1507.0112">[!interfaceManager.isExternalInterface]</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="140.5" x2="182.5" y1="1535.937" y2="1535.937"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="182.5" x2="182.5" y1="1535.937" y2="1548.937"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="141.5" x2="182.5" y1="1548.937" y2="1548.937"/><polygon fill="#A80036" points="151.5,1544.937,141.5,1548.937,151.5,1552.937,147.5,1548.937" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="158" x="147.5" y="1531.0806">programRemoteDmacFlow&quot;</text><text fill="#EE3B3B" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="82" x="309.5" y="1531.0806">table 51 &#x76F8;&#x5173;</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="140.5" x2="182.5" y1="1599.6914" y2="1599.6914"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="182.5" x2="182.5" y1="1599.6914" y2="1612.6914"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="135.5" x2="182.5" y1="1612.6914" y2="1612.6914"/><polygon fill="#A80036" points="145.5,1608.6914,135.5,1612.6914,145.5,1616.6914,141.5,1612.6914" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="71" x="147.5" y="1594.835">bindService&quot;</text><text fill="#EE3B3B" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="111" x="222.5" y="1594.835">table 17 /220 &#x76F8;&#x5173;</text><!--
@startuml
title vlan网络创建
ElanInterfaceManager ->ElanInterfaceManager:add
activate ElanInterfaceManager #8B8989
activate ElanInterfaceManager
alt elanInstance not exit
    ElanInterfaceManager ->ElanUtils:updateOperationalDataStore(elanInstance)
end

alt  elan tag is not updated
    ElanInterfaceManager->ElanInterfaceManager:unProcessedElanInterfaces.put(elanInstanceName, elanInterfaces);
    ElanInterfaceManager->ElanInterfaceManager:return void
end
deactivate ElanInterfaceManager
ElanInterfaceManager->InterfaceAddWorkerOnElan:call(队列执行)
InterfaceAddWorkerOnElan -> ElanInterfaceManager:addElanInterface
alt elanInfo==null
ElanInterfaceManager -> ElanUtils:updateOperationalDataStore(idManager, elanInstance, elanInterfaces, tx) "<font color=#00B2EE><b> 更新操作库
else  
ElanInterfaceManager -> ElanInterfaceManager:createElanStateList(elanInstanceName, interfaceName, tx) "<font color=#00B2EE><b> 更新操作库 elan:elan-state
end

alt dpId != null && !dpId.equals(ElanConstants.INVALID_DPN
    alt isFirstInterfaceInDpn
        alt isVxlanNetworkOrVxlanSegment(elanInstance)
            ElanInterfaceManager -> ElanInterfaceManager:setExternalTunnelTable "<font color=#EE3B3B><b> table 38 流表相关；The 1st ElanInterface in a \n <font color=#EE3B3B><b> DPN must program the Ext Tunnel table, but only if Elan has VNI     
        end
        ElanInterfaceManager -> ElanL2GatewayUtils:installElanL2gwDevicesLocalMacsInDpn "<font color=#EE3B3B><b> table 51 流表相关
    else
        ElanInterfaceManager -> ElanL2GatewayUtils:installElanL2gwDevicesLocalMacsInDpn "<font color=#EE3B3B><b> table 51 流表相关
        ElanInterfaceManager ->ElanInterfaceManager:updateElanDpnInterfacesList  "<font color=#00B2EE><b> 更新操作库 elan:elan-dpn-interfaces
    end
end
ElanInterfaceManager ->ElanInterfaceManager:createElanInterfaceTablesList"<font color=#00B2EE><b> 更新操作库 elan:elan-interface-forwarding-entries
ElanInterfaceManager ->ElanInterfaceManager:installEntriesForFirstInterfaceonDpn
ElanInterfaceManager ->ElanInterfaceManager:setupStandardLocalBroadcastGroups "<font color=#EE3B3B><b> group local 相关
ElanInterfaceManager ->ElanInterfaceManager:setupLeavesLocalBroadcastGroups"<font color=#EE3B3B><b> group local 相关， etree 网络模型

alt ElanUtils.isVlan(elanInstance) && !elanInstance.isExternal()
    alt interfaceManager.isExternalInterface(interfaceName)
        ElanInterfaceManager ->ElanInterfaceManager:handleExternalInterfaceEvent
        ElanInterfaceManager ->ElanL2GatewayMulticastUtils:setupStandardElanBroadcastGroups"<font color=#EE3B3B><b> group remote 相关， etree 网络模型
    end
end
alt isFirstInterfaceInDpn && isVxlanNetworkOrVxlanSegment(elanInstance)
    ElanInterfaceManager ->ElanInterfaceManager:setElanAndEtreeBCGrouponOtherDpns(elanInstance, dpId)
    note left
        还有一些逻辑
    end note
end

ElanInterfaceManager ->InterfaceAddWorkerOnElanInterface:caLL
ElanInterfaceManager ->ElanInterfaceManager:setupEntriesForElanInterface
ElanInterfaceManager ->ElanInterfaceManager:installEntriesForElanInterface
ElanInterfaceManager ->ElanInterfaceManager:setupFilterEqualsTable"<font color=#EE3B3B><b> table 55 相关

alt isFirstInterfaceInDpn
    alt (isVxlanNetworkOrVxlanSegment(elanInstance)) 
        ElanInterfaceManager ->ElanInterfaceManager:setupTerminateServiceTable "<font color=#EE3B3B><b> table 36 相关        
    end
    ElanInterfaceManager ->ElanInterfaceManager:setupUnknownDMacTable"<font color=#EE3B3B><b> table 52 相关
    alt !interfaceManager.isExternalInterface
        ElanInterfaceManager ->ElanInterfaceManager:programRemoteDmacFlow"<font color=#EE3B3B><b> table 51 相关
    end
end
ElanInterfaceManager ->ElanInterfaceManager:bindService"<font color=#EE3B3B><b> table 17 /220 相关
deactivate ElanInterfaceManager


@enduml

PlantUML version 1.2019.07(Tue Jun 25 03:59:20 CST 2019)
(MIT source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) 64-Bit Server VM
Java Version: 1.8.0_191-b12
Operating System: Windows 10
OS Version: 10.0
Default Encoding: GBK
Language: zh
Country: CN
--></g></svg></p><p>&#x521B;&#x5EFA;vlan &#x7F51;&#x7EDC; &#x4E0B;&#x53D1;&#x6D41;&#x8868;&#x793A;&#x4F8B;</p>
<pre data-role="codeBlock" data-info="text" class="language-text"><code>table=0, priority=4,in_port=3,vlan_tci=0x0000/0x1fff actions=write_metadata:0x90000000001/0xffffff0000000001,goto_table:17
table=0, priority=10,in_port=3,dl_vlan=10 actions=pop_vlan,write_metadata:0xa0000000001/0xffffff0000000001,goto_table:17
table=17, priority=10,metadata=0xa0000000000/0xffffff0000000000 actions=load:0xa-&gt;NXM_NX_REG1[0..19],load:0x138a-&gt;NXM_NX_REG7[0..15],write_metadata:0xa0000a138a000000/0xfffffffffffffffe,goto_table:43
table=52, priority=5,metadata=0x138a000000/0xffff000001 actions=write_actions(group:210004)
table=52, priority=5,metadata=0x138a000001/0xffff000001 actions=write_actions(group:210003)
table=55, priority=10,tun_id=0xa,metadata=0xa0000000000/0xfffff0000000000 actions=drop
table=55, priority=9,tun_id=0xa actions=load:0xa00-&gt;NXM_NX_REG6[],resubmit(,220)
table=220, priority=10,reg6=0x900,metadata=0x1/0x1 actions=drop
table=220, priority=10,reg6=0xa00,metadata=0x1/0x1 actions=drop
table=220, priority=9,reg6=0x900 actions=output:3
table=220, priority=9,reg6=0xa00 actions=push_vlan:0x8100,set_field:4106-&gt;vlan_vid,output:3
</code></pre><pre data-role="codeBlock" data-info="text" class="language-text"><code>group_id=210003,type=all
group_id=210004,type=all,bucket=actions=group:210003,bucket=actions=load:0xa00-&gt;NXM_NX_REG6[],resubmit(,220)
</code></pre><details>
  <summary><mark><font color="darkred">&#x70B9;&#x51FB;&#x67E5;&#x770B;&#x8BE6;&#x7EC6;&#x5185;&#x5BB9;</font></mark></summary>
  <p> - &#x6D4B;&#x8BD5; &#x6D4B;&#x8BD5;&#x6D4B;&#x8BD5;</p>
  <pre class="language-text">  
for i in a:
    print(i)
  </pre>
</details>
</div></body></html>
    </div>
  </body>
</html>
