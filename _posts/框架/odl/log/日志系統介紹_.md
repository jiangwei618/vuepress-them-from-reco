---
title: 日志系统基本介绍
date: 2019-08-22T17:09:22.000Z
description: 'log系统 基本介绍'
categories:
    - 框架
    - odl
    - log
tags:
    - odl
    - log
---  
  
  
##  1. 日志系统简介
  
  
karaf 在 4.0 版本后开始支持 log4j2。同时 karaf 也只是 logback 配置。
[log4j2 地址](http://logging.apache.org/log4j/2.x/ )
  
##  2. 配置实例
  
  
```profile
 ################################################################################
 #
 #    Licensed to the Apache Software Foundation (ASF) under one or more
 #    contributor license agreements.  See the NOTICE file distributed with
 #    this work for additional information regarding copyright ownership.
 #    The ASF licenses this file to You under the Apache License, Version 2.0
 #    (the "License"); you may not use this file except in compliance with
 #    the License.  You may obtain a copy of the License at
 #
 #       http://www.apache.org/licenses/LICENSE-2.0
 #
 #    Unless required by applicable law or agreed to in writing, software
 #    distributed under the License is distributed on an "AS IS" BASIS,
 #    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 #    See the License for the specific language governing permissions and
 #    limitations under the License.
 #
 ################################################################################
  
 # Common pattern layout for appenders
 log4j2.pattern = %d{ISO8601} | %-5p | %-16t | %-32c{1}%-5.5L | %X{bundle.id} - %X{bundle.name} - %X{bundle.version} | %m%n
  
 # Root logger
 log4j2.rootLogger.level = WARN
 # uncomment to use asynchronous loggers, which require mvn:com.lmax/disruptor/3.3.2 library
 #log4j2.rootLogger.type = asyncRoot
 #log4j2.rootLogger.includeLocation = false
 log4j2.rootLogger.appenderRef.RollingFile.ref = RollingFile
 log4j2.rootLogger.appenderRef.PaxOsgi.ref = PaxOsgi
 log4j2.rootLogger.appenderRef.Console.ref = Console
 log4j2.rootLogger.appenderRef.Console.filter.threshold.type = ThresholdFilter
 log4j2.rootLogger.appenderRef.Console.filter.threshold.level = ${karaf.log.console:-OFF}
  
  
 # Loggers configuration
  
 # Spifly logger
 log4j2.logger.spifly.name = org.apache.aries.spifly
 log4j2.logger.spifly.level = WARN
  
 # Security audit logger
 log4j2.logger.audit.name = org.apache.karaf.jaas.modules.audit
 log4j2.logger.audit.level = INFO
 log4j2.logger.audit.additivity = false
 log4j2.logger.audit.appenderRef.AuditRollingFile.ref = AuditRollingFile
  
 # ice-northbound logger
 log4j2.logger.icenorthbound.name = com.inspur.ice.neutron.northbound.utils.HttpAuthTool
 log4j2.logger.icenorthbound.level = INFO
 log4j2.logger.icenorthbound.additivity = false
 log4j2.logger.icenorthbound.appenderRef.icenorthboundRollingFile.ref = icenorthboundRollingFile
  
 # ice-underlay logger
 log4j2.logger.iceSSH.name = com.inspur.ice.impl.SshcProvider
 log4j2.logger.iceSSH.level = INFO
 log4j2.logger.iceSSH.additivity = false
 log4j2.logger.iceSSH.appenderRef.iceSSHRollingFile.ref = iceSSHRollingFile
  
 # openflow logger
 log4j2.logger.openflow.name = org.opendaylight.MDSALManager
 log4j2.logger.openflow.level = DEBUG
 log4j2.logger.openflow.additivity = false
 log4j2.logger.openflow.appenderRef.openflowFile.ref = openflowFile
  
  
 # conntroller logger
 log4j2.logger.controller.name = org.opendaylight.controller
 log4j2.logger.controller.level = DEBUG
 log4j2.logger.controller.additivity = false
 log4j2.logger.controller.appenderRef.controllerFile.ref = controllerFile
  
 # Appenders configuration
  
 # Console appender not used by default (see log4j2.rootLogger.appenderRefs)
 log4j2.appender.console.type = Console
 log4j2.appender.console.name = Console
 log4j2.appender.console.layout.type = PatternLayout
 log4j2.appender.console.layout.pattern = ${log4j2.pattern}
  
 # Rolling file appender
 log4j2.appender.rolling.type = RollingRandomAccessFile
 log4j2.appender.rolling.name = RollingFile
 log4j2.appender.rolling.fileName = ${karaf.data}/log/karaf.log
 log4j2.appender.rolling.filePattern = ${karaf.data}/log/karaf.log.%i
 # uncomment to not force a disk flush
 #log4j2.appender.rolling.immediateFlush = false
 log4j2.appender.rolling.append = true
 log4j2.appender.rolling.layout.type = PatternLayout
 log4j2.appender.rolling.layout.pattern = ${log4j2.pattern}
 log4j2.appender.rolling.policies.type = Policies
 log4j2.appender.rolling.policies.size.type = SizeBasedTriggeringPolicy
 log4j2.appender.rolling.policies.size.size = 16MB
  
 # Audit file appender
 log4j2.appender.audit.type = RollingRandomAccessFile
 log4j2.appender.audit.name = AuditRollingFile
 log4j2.appender.audit.fileName = ${karaf.data}/security/audit.log
 log4j2.appender.audit.filePattern = ${karaf.data}/security/audit.log.%i
 log4j2.appender.audit.append = true
 log4j2.appender.audit.layout.type = PatternLayout
 log4j2.appender.audit.layout.pattern = ${log4j2.pattern}
 log4j2.appender.audit.policies.type = Policies
 log4j2.appender.audit.policies.size.type = SizeBasedTriggeringPolicy
 log4j2.appender.audit.policies.size.size = 8MB
  
 # OSGi appender
 log4j2.appender.osgi.type = PaxOsgi
 log4j2.appender.osgi.name = PaxOsgi
 log4j2.appender.osgi.filter = *
  
 # ice-northbound file appender
 log4j2.appender.icenorthbound.type = RollingRandomAccessFile
 log4j2.appender.icenorthbound.name = icenorthboundRollingFile
 log4j2.appender.icenorthbound.fileName = ${karaf.data}/log/ice-northbound/ice-northbound.log
 log4j2.appender.icenorthbound.filePattern = ${karaf.data}/log/ice-northbound/ice-northbound-%i.log.gz
 log4j2.appender.icenorthbound.append = true
 log4j2.appender.icenorthbound.layout.type = PatternLayout
 log4j2.appender.icenorthbound.layout.pattern = %d{ISO8601} | %-16.16t | %-16.16c{1}%-5.5L | %-5.5p | %m%n
 log4j2.appender.icenorthbound.policies.type = Policies
 log4j2.appender.icenorthbound.policies.size.type = SizeBasedTriggeringPolicy
 log4j2.appender.icenorthbound.policies.size.size = 100MB
 log4j2.appender.icenorthbound.strategy.type = DefaultRolloverStrategy
 log4j2.appender.icenorthbound.strategy.max = 10
  
 # ice-underlay file appender
 log4j2.appender.iceSSH.type = RollingRandomAccessFile
 log4j2.appender.iceSSH.name = iceSSHRollingFile
 log4j2.appender.iceSSH.fileName = ${karaf.data}/log/ice-SSH/ice-SSH.log
 log4j2.appender.iceSSH.filePattern = ${karaf.data}/log/ice-SSH/ice-SSH-%i.log.gz
 log4j2.appender.iceSSH.append = true
 log4j2.appender.iceSSH.layout.type = PatternLayout
 log4j2.appender.iceSSH.layout.pattern = %d{ISO8601} | %-16.16t | %-16.16c{1}%-5.5L | %-5.5p | %m%n
 log4j2.appender.iceSSH.policies.type = Policies
 log4j2.appender.iceSSH.policies.size.type = SizeBasedTriggeringPolicy
 log4j2.appender.iceSSH.policies.size.size = 100MB
 log4j2.appender.iceSSH.strategy.type = DefaultRolloverStrategy
 log4j2.appender.iceSSH.strategy.max = 10
  
 # controller file appender
 log4j2.appender.controller.type = RollingRandomAccessFile
 log4j2.appender.controller.name = controllerFile
 log4j2.appender.controller.fileName = ${karaf.data}/log/controller/controller.log
 log4j2.appender.controller.filePattern = ${karaf.data}/log/controller/controller-%i.log.gz
 log4j2.appender.controller.append = true
 log4j2.appender.controller.layout.type = PatternLayout
 log4j2.appender.controller.layout.pattern = %d{ISO8601} | %t | %c|  %-5.5L | %-5.5p | %m%n
 log4j2.appender.controller.policies.type = Policies
 log4j2.appender.controller.policies.size.type = SizeBasedTriggeringPolicy
 log4j2.appender.controller.policies.size.size = 100MB
 log4j2.appender.controller.strategy.type = DefaultRolloverStrategy
 log4j2.appender.controller.strategy.max = 10
 #filter 配置
 #onMisMatch 字母大写，和官网不一样；使用小写时会报错
 log4j2.appender.controller.filter.regexFilter.type = RegexFilter
 log4j2.appender.controller.filter.regexFilter.onMatch = DENY
 log4j2.appender.controller.filter.regexFilter.onMisMatch = ACCEPT
 log4j2.appender.controller.filter.regexFilter.regex = .*urn:opendayligh.*
  
  
  
  
 # openflow file appender
 log4j2.appender.openflow.type = RollingRandomAccessFile
 log4j2.appender.openflow.name = openflowFile
 log4j2.appender.openflow.fileName = ${karaf.data}/log/openflow/openflow.log
 log4j2.appender.openflow.filePattern = ${karaf.data}/log/openflow/openflow-%i.log.gz
 log4j2.appender.openflow.append = true
 log4j2.appender.openflow.layout.type = PatternLayout
 log4j2.appender.openflow.layout.pattern = %d{ISO8601} | %-16.16t | %-16.16c{1}%-5.5L | %-5.5p | %m%n
 log4j2.appender.openflow.policies.type = Policies
 log4j2.appender.openflow.policies.size.type = SizeBasedTriggeringPolicy
 log4j2.appender.openflow.policies.size.size = 100MB
 log4j2.appender.openflow.strategy.type = DefaultRolloverStrategy
 log4j2.appender.openflow.strategy.max = 10
 log4j.appender.trapmsg = org.apache.log4j.RollingFileAppender
 log4j.appender.trapmsg.append = true
 log4j.appender.trapmsg.file = /root/source_reform/ice-karaf-0.1.0/data/log/trap/trap.log
 log4j.appender.trapmsg.layout = org.apache.log4j.PatternLayout
 log4j.appender.trapmsg.layout.ConversionPattern = %d{ISO8601} | %-5.5p | %-16.16t | %-32.32c{1} | %m%n
 log4j.appender.trapmsg.maxBackupIndex = 10
 log4j.appender.trapmsg.maxFileSize = 1MB
 log4j.logger.com.inspur.ice.trap.impl = INFO, trapmsg
 log4j2.logger.org_opendaylight_controller_sal_core_spi_data.level = INFO
 log4j2.logger.org_opendaylight_controller_sal_core_spi_data.name = org.opendaylight.controller.sal.core.spi.data
  
```
  